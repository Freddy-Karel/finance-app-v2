"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_server_actions_reports_ts";
exports.ids = ["_action-browser_src_server_actions_reports_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentRole: () => (/* binding */ getCurrentRole),\n/* harmony export */   requireRole: () => (/* binding */ requireRole)\n/* harmony export */ });\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(action-browser)/./node_modules/.pnpm/@clerk+nextjs@5.3.1_next@15_20ea36d09dc70bbbcc56b8a0d9ae486b/node_modules/@clerk/nextjs/dist/esm/app-router/server/auth.js\");\n\nasync function getCurrentRole() {\n    if (process.env.E2E_ROLE === \"operator\" || process.env.E2E_ROLE === \"manager\" || process.env.E2E_ROLE === \"auditor\") return process.env.E2E_ROLE;\n    const { userId, sessionClaims } = (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_0__.auth)();\n    if (!userId) throw new Error(\"Unauthenticated\");\n    return sessionClaims?.role ?? \"operator\";\n}\nasync function requireRole(allowed) {\n    const role = await getCurrentRole();\n    if (!allowed.includes(role)) throw new Error(\"Forbidden\");\n    return role;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEM7QUFFckMsZUFBZUM7SUFDcEIsSUFBSUMsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssY0FBY0YsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssYUFBYUYsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssV0FBVyxPQUFPRixRQUFRQyxHQUFHLENBQUNDLFFBQVE7SUFDaEosTUFBTSxFQUFFQyxNQUFNLEVBQUVDLGFBQWEsRUFBRSxHQUFHTiwwREFBSUE7SUFBSSxJQUFJLENBQUNLLFFBQVEsTUFBTSxJQUFJRSxNQUFNO0lBQ3ZFLE9BQU8sZUFBZ0JDLFFBQTZCO0FBQ3REO0FBQ08sZUFBZUMsWUFBWUMsT0FBZTtJQUFJLE1BQU1GLE9BQU8sTUFBTVA7SUFBa0IsSUFBSSxDQUFDUyxRQUFRQyxRQUFRLENBQUNILE9BQU8sTUFBTSxJQUFJRCxNQUFNO0lBQWMsT0FBT0M7QUFBTSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcbGliXFxhdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGF1dGggfSBmcm9tIFwiQGNsZXJrL25leHRqcy9zZXJ2ZXJcIjtcbmV4cG9ydCB0eXBlIFJvbGUgPSBcIm9wZXJhdG9yXCIgfCBcIm1hbmFnZXJcIiB8IFwiYXVkaXRvclwiO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRSb2xlKCk6IFByb21pc2U8Um9sZT4ge1xuICBpZiAocHJvY2Vzcy5lbnYuRTJFX1JPTEUgPT09IFwib3BlcmF0b3JcIiB8fCBwcm9jZXNzLmVudi5FMkVfUk9MRSA9PT0gXCJtYW5hZ2VyXCIgfHwgcHJvY2Vzcy5lbnYuRTJFX1JPTEUgPT09IFwiYXVkaXRvclwiKSByZXR1cm4gcHJvY2Vzcy5lbnYuRTJFX1JPTEUgYXMgUm9sZTtcbiAgY29uc3QgeyB1c2VySWQsIHNlc3Npb25DbGFpbXMgfSA9IGF1dGgoKTsgaWYgKCF1c2VySWQpIHRocm93IG5ldyBFcnJvcihcIlVuYXV0aGVudGljYXRlZFwiKTtcbiAgcmV0dXJuIChzZXNzaW9uQ2xhaW1zPy5yb2xlIGFzIFJvbGUgfCB1bmRlZmluZWQpID8/IFwib3BlcmF0b3JcIjtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUm9sZShhbGxvd2VkOiBSb2xlW10pIHsgY29uc3Qgcm9sZSA9IGF3YWl0IGdldEN1cnJlbnRSb2xlKCk7IGlmICghYWxsb3dlZC5pbmNsdWRlcyhyb2xlKSkgdGhyb3cgbmV3IEVycm9yKFwiRm9yYmlkZGVuXCIpOyByZXR1cm4gcm9sZTsgfVxuIl0sIm5hbWVzIjpbImF1dGgiLCJnZXRDdXJyZW50Um9sZSIsInByb2Nlc3MiLCJlbnYiLCJFMkVfUk9MRSIsInVzZXJJZCIsInNlc3Npb25DbGFpbXMiLCJFcnJvciIsInJvbGUiLCJyZXF1aXJlUm9sZSIsImFsbG93ZWQiLCJpbmNsdWRlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(action-browser)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = global.__prisma ??= new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) global.__prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQVN2QyxNQUFNQyxTQUFVQyxPQUFPQyxRQUFRLEtBQUssSUFBSUgsd0RBQVlBLEdBQUk7QUFDL0QsSUFBSUksSUFBcUMsRUFBRUYsT0FBT0MsUUFBUSxHQUFHRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcbGliXFxwcmlzbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG4vLyBFbnN1cmUgYSBzaW5nbGUgUHJpc21hQ2xpZW50IGluc3RhbmNlIGluIGRldmVsb3BtZW50IHRvIGF2b2lkIGV4aGF1c3Rpbmdcbi8vIGRhdGFiYXNlIGNvbm5lY3Rpb25zIGR1cmluZyBITVIgKHNlZSBQcmlzbWEgZG9jcykuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSAoZ2xvYmFsLl9fcHJpc21hID8/PSBuZXcgUHJpc21hQ2xpZW50KCkpO1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbC5fX3ByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJfX3ByaXNtYSIsInByb2Nlc3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/actions/reports.ts":
/*!***************************************!*\
  !*** ./src/server/actions/reports.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   exportEnvelopeExecutionCSV: () => (/* binding */ exportEnvelopeExecutionCSV),\n/* harmony export */   exportTransactionsCSV: () => (/* binding */ exportTransactionsCSV),\n/* harmony export */   getEnvelopeExecutionReport: () => (/* binding */ getEnvelopeExecutionReport),\n/* harmony export */   getTransactionsReport: () => (/* binding */ getTransactionsReport)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(action-browser)/./src/lib/auth.ts\");\n/* harmony import */ var _server_validators_reports__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/server/validators/reports */ \"(action-browser)/./src/server/validators/reports.ts\");\n/* harmony import */ var _server_queries_reports__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/server/queries/reports */ \"(action-browser)/./src/server/queries/reports.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"407008847889662bcae8ba68d74f3e26b2ec34100f\":\"exportEnvelopeExecutionCSV\",\"40ada511f12213b065b0c7919221da7e7359e8cd61\":\"getEnvelopeExecutionReport\",\"40e27335848c54e475e0aea47f6abd9de7d6668a80\":\"exportTransactionsCSV\",\"40eb82256fc2a74fe8a26d728a4ca6c7e8cbde5d7d\":\"getTransactionsReport\"} */ \n\n\n\n\nasync function getTransactionsReport(input) {\n    await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireRole)([\n        \"auditor\",\n        \"manager\",\n        \"operator\"\n    ]);\n    const p = _server_validators_reports__WEBPACK_IMPORTED_MODULE_3__.TransactionsReportSchema.safeParse({\n        ...input,\n        limit: 200,\n        offset: 0\n    });\n    if (!p.success) throw new Error(p.error.errors.map((e)=>e.message).join(\"; \"));\n    return (0,_server_queries_reports__WEBPACK_IMPORTED_MODULE_4__.fetchTransactionsReport)(p.data);\n}\nasync function getEnvelopeExecutionReport(input) {\n    await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.requireRole)([\n        \"auditor\",\n        \"manager\",\n        \"operator\"\n    ]);\n    const p = _server_validators_reports__WEBPACK_IMPORTED_MODULE_3__.EnvelopeExecutionReportSchema.safeParse(input);\n    if (!p.success) throw new Error(p.error.errors.map((e)=>e.message).join(\"; \"));\n    return (0,_server_queries_reports__WEBPACK_IMPORTED_MODULE_4__.fetchEnvelopeExecution)(p.data);\n}\nasync function exportTransactionsCSV(input) {\n    const rows = await getTransactionsReport(input);\n    return (0,_server_queries_reports__WEBPACK_IMPORTED_MODULE_4__.toCSV)(rows.map((r)=>({\n            id: r.id,\n            kind: r.kind,\n            label: r.label,\n            amount: r.amount,\n            at: new Date(r.at).toISOString(),\n            serviceId: r.serviceId ?? \"\",\n            allocations: r.allocations.map((a)=>`${a.envelopeName}:${a.amount}`).join(\"|\")\n        })));\n}\nasync function exportEnvelopeExecutionCSV(input) {\n    const rows = await getEnvelopeExecutionReport(input);\n    return (0,_server_queries_reports__WEBPACK_IMPORTED_MODULE_4__.toCSV)(rows.map((r)=>({\n            envelopeId: r.envelopeId,\n            name: r.name,\n            inflow: r.inflow,\n            outflow: r.outflow,\n            delta: r.delta\n        })));\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    getTransactionsReport,\n    getEnvelopeExecutionReport,\n    exportTransactionsCSV,\n    exportEnvelopeExecutionCSV\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(getTransactionsReport, \"40eb82256fc2a74fe8a26d728a4ca6c7e8cbde5d7d\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(getEnvelopeExecutionReport, \"40ada511f12213b065b0c7919221da7e7359e8cd61\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(exportTransactionsCSV, \"40e27335848c54e475e0aea47f6abd9de7d6668a80\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(exportEnvelopeExecutionCSV, \"407008847889662bcae8ba68d74f3e26b2ec34100f\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvYWN0aW9ucy9yZXBvcnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFDeUM7QUFDNkQ7QUFDSjtBQUczRixlQUFlTSxzQkFBc0JDLEtBQTRHO0lBQ3RKLE1BQU1QLHNEQUFXQSxDQUFDO1FBQUM7UUFBVztRQUFXO0tBQVc7SUFDcEQsTUFBTVEsSUFBSVAsZ0ZBQXdCQSxDQUFDUSxTQUFTLENBQUM7UUFBRSxHQUFHRixLQUFLO1FBQUVHLE9BQU87UUFBS0MsUUFBUTtJQUFFO0lBQy9FLElBQUksQ0FBQ0gsRUFBRUksT0FBTyxFQUFFLE1BQU0sSUFBSUMsTUFBTUwsRUFBRU0sS0FBSyxDQUFDQyxNQUFNLENBQUNDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsT0FBTyxFQUFFQyxJQUFJLENBQUM7SUFDeEUsT0FBT2hCLGdGQUF1QkEsQ0FBQ0ssRUFBRVksSUFBSTtBQUN2QztBQUVPLGVBQWVDLDJCQUEyQmQsS0FBcUM7SUFDcEYsTUFBTVAsc0RBQVdBLENBQUM7UUFBQztRQUFXO1FBQVc7S0FBVztJQUNwRCxNQUFNUSxJQUFJTixxRkFBNkJBLENBQUNPLFNBQVMsQ0FBQ0Y7SUFDbEQsSUFBSSxDQUFDQyxFQUFFSSxPQUFPLEVBQUUsTUFBTSxJQUFJQyxNQUFNTCxFQUFFTSxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFQyxPQUFPLEVBQUVDLElBQUksQ0FBQztJQUN4RSxPQUFPZiwrRUFBc0JBLENBQUNJLEVBQUVZLElBQUk7QUFDdEM7QUFFTyxlQUFlRSxzQkFBc0JmLEtBQTRHO0lBQ3RKLE1BQU1nQixPQUFPLE1BQU1qQixzQkFBc0JDO0lBQ3pDLE9BQU9GLDhEQUFLQSxDQUFDa0IsS0FBS1AsR0FBRyxDQUFDLENBQUNRLElBQXVCO1lBQzVDQyxJQUFJRCxFQUFFQyxFQUFFO1lBQ1JDLE1BQU1GLEVBQUVFLElBQUk7WUFDWkMsT0FBT0gsRUFBRUcsS0FBSztZQUNkQyxRQUFRSixFQUFFSSxNQUFNO1lBQ2hCQyxJQUFJLElBQUlDLEtBQUtOLEVBQUVLLEVBQUUsRUFBRUUsV0FBVztZQUM5QkMsV0FBV1IsRUFBRVEsU0FBUyxJQUFJO1lBQzFCQyxhQUFhVCxFQUFFUyxXQUFXLENBQUNqQixHQUFHLENBQUMsQ0FBQ2tCLElBQWtCLEdBQUdBLEVBQUVDLFlBQVksQ0FBQyxDQUFDLEVBQUVELEVBQUVOLE1BQU0sRUFBRSxFQUFFVCxJQUFJLENBQUM7UUFDMUY7QUFDRjtBQUVPLGVBQWVpQiwyQkFBMkI3QixLQUFxQztJQUNwRixNQUFNZ0IsT0FBTyxNQUFNRiwyQkFBMkJkO0lBQzlDLE9BQU9GLDhEQUFLQSxDQUFDa0IsS0FBS1AsR0FBRyxDQUFDLENBQUNRLElBQTZCO1lBQ2xEYSxZQUFZYixFQUFFYSxVQUFVO1lBQ3hCQyxNQUFNZCxFQUFFYyxJQUFJO1lBQ1pDLFFBQVFmLEVBQUVlLE1BQU07WUFDaEJDLFNBQVNoQixFQUFFZ0IsT0FBTztZQUNsQkMsT0FBT2pCLEVBQUVpQixLQUFLO1FBQ2hCO0FBQ0Y7OztJQXBDc0JuQztJQU9BZTtJQU9BQztJQWFBYzs7QUEzQkE5QiwwRkFBQUEsQ0FBQUE7QUFPQWUsMEZBQUFBLENBQUFBO0FBT0FDLDBGQUFBQSxDQUFBQTtBQWFBYywwRkFBQUEsQ0FBQUEiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxcYWN0aW9uc1xccmVwb3J0cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzZXJ2ZXJcIjtcbmltcG9ydCB7IHJlcXVpcmVSb2xlIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcbmltcG9ydCB7IFRyYW5zYWN0aW9uc1JlcG9ydFNjaGVtYSwgRW52ZWxvcGVFeGVjdXRpb25SZXBvcnRTY2hlbWEgfSBmcm9tIFwiQC9zZXJ2ZXIvdmFsaWRhdG9ycy9yZXBvcnRzXCI7XG5pbXBvcnQgeyBmZXRjaFRyYW5zYWN0aW9uc1JlcG9ydCwgZmV0Y2hFbnZlbG9wZUV4ZWN1dGlvbiwgdG9DU1YgfSBmcm9tIFwiQC9zZXJ2ZXIvcXVlcmllcy9yZXBvcnRzXCI7XG5pbXBvcnQgdHlwZSB7IFRyYW5zYWN0aW9uUm93LCBFbnZlbG9wZUV4ZWN1dGlvblJvdywgQWxsb2NhdGlvbiB9IGZyb20gXCJAL3NlcnZlci90eXBlc1wiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VHJhbnNhY3Rpb25zUmVwb3J0KGlucHV0OiB7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nOyB0eXBlPzogXCJJTlwiIHwgXCJPVVRcIiB8IFwiRElTVFwiOyBlbnZlbG9wZUlkPzogc3RyaW5nOyBzZXJ2aWNlSWQ/OiBzdHJpbmcgfSk6IFByb21pc2U8VHJhbnNhY3Rpb25Sb3dbXT4ge1xuICBhd2FpdCByZXF1aXJlUm9sZShbXCJhdWRpdG9yXCIsIFwibWFuYWdlclwiLCBcIm9wZXJhdG9yXCJdKTtcbiAgY29uc3QgcCA9IFRyYW5zYWN0aW9uc1JlcG9ydFNjaGVtYS5zYWZlUGFyc2UoeyAuLi5pbnB1dCwgbGltaXQ6IDIwMCwgb2Zmc2V0OiAwIH0pO1xuICBpZiAoIXAuc3VjY2VzcykgdGhyb3cgbmV3IEVycm9yKHAuZXJyb3IuZXJyb3JzLm1hcChlID0+IGUubWVzc2FnZSkuam9pbihcIjsgXCIpKTtcbiAgcmV0dXJuIGZldGNoVHJhbnNhY3Rpb25zUmVwb3J0KHAuZGF0YSkgYXMgUHJvbWlzZTxUcmFuc2FjdGlvblJvd1tdPjtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEVudmVsb3BlRXhlY3V0aW9uUmVwb3J0KGlucHV0OiB7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nIH0pOiBQcm9taXNlPEVudmVsb3BlRXhlY3V0aW9uUm93W10+IHtcbiAgYXdhaXQgcmVxdWlyZVJvbGUoW1wiYXVkaXRvclwiLCBcIm1hbmFnZXJcIiwgXCJvcGVyYXRvclwiXSk7XG4gIGNvbnN0IHAgPSBFbnZlbG9wZUV4ZWN1dGlvblJlcG9ydFNjaGVtYS5zYWZlUGFyc2UoaW5wdXQpO1xuICBpZiAoIXAuc3VjY2VzcykgdGhyb3cgbmV3IEVycm9yKHAuZXJyb3IuZXJyb3JzLm1hcChlID0+IGUubWVzc2FnZSkuam9pbihcIjsgXCIpKTtcbiAgcmV0dXJuIGZldGNoRW52ZWxvcGVFeGVjdXRpb24ocC5kYXRhKSBhcyBQcm9taXNlPEVudmVsb3BlRXhlY3V0aW9uUm93W10+O1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXhwb3J0VHJhbnNhY3Rpb25zQ1NWKGlucHV0OiB7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nOyB0eXBlPzogXCJJTlwiIHwgXCJPVVRcIiB8IFwiRElTVFwiOyBlbnZlbG9wZUlkPzogc3RyaW5nOyBzZXJ2aWNlSWQ/OiBzdHJpbmcgfSkge1xuICBjb25zdCByb3dzID0gYXdhaXQgZ2V0VHJhbnNhY3Rpb25zUmVwb3J0KGlucHV0KSBhcyBUcmFuc2FjdGlvblJvd1tdO1xuICByZXR1cm4gdG9DU1Yocm93cy5tYXAoKHI6IFRyYW5zYWN0aW9uUm93KSA9PiAoe1xuICAgIGlkOiByLmlkLFxuICAgIGtpbmQ6IHIua2luZCxcbiAgICBsYWJlbDogci5sYWJlbCxcbiAgICBhbW91bnQ6IHIuYW1vdW50LFxuICAgIGF0OiBuZXcgRGF0ZShyLmF0KS50b0lTT1N0cmluZygpLFxuICAgIHNlcnZpY2VJZDogci5zZXJ2aWNlSWQgPz8gXCJcIixcbiAgICBhbGxvY2F0aW9uczogci5hbGxvY2F0aW9ucy5tYXAoKGE6IEFsbG9jYXRpb24pID0+IGAke2EuZW52ZWxvcGVOYW1lfToke2EuYW1vdW50fWApLmpvaW4oXCJ8XCIpXG4gIH0pKSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBleHBvcnRFbnZlbG9wZUV4ZWN1dGlvbkNTVihpbnB1dDogeyBzdGFydDogc3RyaW5nOyBlbmQ6IHN0cmluZyB9KSB7XG4gIGNvbnN0IHJvd3MgPSBhd2FpdCBnZXRFbnZlbG9wZUV4ZWN1dGlvblJlcG9ydChpbnB1dCkgYXMgRW52ZWxvcGVFeGVjdXRpb25Sb3dbXTtcbiAgcmV0dXJuIHRvQ1NWKHJvd3MubWFwKChyOiBFbnZlbG9wZUV4ZWN1dGlvblJvdykgPT4gKHtcbiAgICBlbnZlbG9wZUlkOiByLmVudmVsb3BlSWQsXG4gICAgbmFtZTogci5uYW1lLFxuICAgIGluZmxvdzogci5pbmZsb3csXG4gICAgb3V0Zmxvdzogci5vdXRmbG93LFxuICAgIGRlbHRhOiByLmRlbHRhXG4gIH0pKSk7XG59XG4iXSwibmFtZXMiOlsicmVxdWlyZVJvbGUiLCJUcmFuc2FjdGlvbnNSZXBvcnRTY2hlbWEiLCJFbnZlbG9wZUV4ZWN1dGlvblJlcG9ydFNjaGVtYSIsImZldGNoVHJhbnNhY3Rpb25zUmVwb3J0IiwiZmV0Y2hFbnZlbG9wZUV4ZWN1dGlvbiIsInRvQ1NWIiwiZ2V0VHJhbnNhY3Rpb25zUmVwb3J0IiwiaW5wdXQiLCJwIiwic2FmZVBhcnNlIiwibGltaXQiLCJvZmZzZXQiLCJzdWNjZXNzIiwiRXJyb3IiLCJlcnJvciIsImVycm9ycyIsIm1hcCIsImUiLCJtZXNzYWdlIiwiam9pbiIsImRhdGEiLCJnZXRFbnZlbG9wZUV4ZWN1dGlvblJlcG9ydCIsImV4cG9ydFRyYW5zYWN0aW9uc0NTViIsInJvd3MiLCJyIiwiaWQiLCJraW5kIiwibGFiZWwiLCJhbW91bnQiLCJhdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNlcnZpY2VJZCIsImFsbG9jYXRpb25zIiwiYSIsImVudmVsb3BlTmFtZSIsImV4cG9ydEVudmVsb3BlRXhlY3V0aW9uQ1NWIiwiZW52ZWxvcGVJZCIsIm5hbWUiLCJpbmZsb3ciLCJvdXRmbG93IiwiZGVsdGEiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/actions/reports.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/queries/reports.ts":
/*!***************************************!*\
  !*** ./src/server/queries/reports.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchEnvelopeExecution: () => (/* binding */ fetchEnvelopeExecution),\n/* harmony export */   fetchTransactionsReport: () => (/* binding */ fetchTransactionsReport),\n/* harmony export */   toCSV: () => (/* binding */ toCSV)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(action-browser)/./src/lib/prisma.ts\");\n\nfunction parseRange(startStr, endStr) {\n    return {\n        start: new Date(startStr + \"T00:00:00.000Z\"),\n        end: new Date(endStr + \"T23:59:59.999Z\")\n    };\n}\nasync function fetchTransactionsReport(p) {\n    const { start, end } = parseRange(p.start, p.end);\n    const where = {\n        at: {\n            gte: start,\n            lte: end\n        }\n    };\n    if (p.type) where.kind = p.type;\n    if (p.serviceId) where.serviceId = p.serviceId;\n    const includeAlloc = !!p.envelopeId || where.kind === \"OUT\" || where.kind === \"DIST\" || !where.kind;\n    const txs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transaction.findMany({\n        where,\n        include: includeAlloc ? {\n            allocs: p.envelopeId ? {\n                where: {\n                    envelopeId: p.envelopeId\n                },\n                include: {\n                    envelope: true\n                }\n            } : {\n                include: {\n                    envelope: true\n                }\n            }\n        } : undefined,\n        orderBy: {\n            at: \"asc\"\n        },\n        take: p.limit,\n        skip: p.offset\n    });\n    return txs.map((t)=>{\n        const rawAllocs = t.allocs ?? [];\n        const allocations = rawAllocs.map((a)=>({\n                envelopeId: a.envelopeId,\n                envelopeName: a.envelope?.name ?? \"\",\n                amount: a.amount\n            }));\n        return {\n            id: t.id,\n            kind: t.kind,\n            label: t.label ?? null,\n            amount: t.amount,\n            at: t.at,\n            serviceId: t.serviceId ?? null,\n            allocations\n        };\n    });\n}\nasync function fetchEnvelopeExecution(p) {\n    const { start, end } = parseRange(p.start, p.end);\n    const inflows = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"DIST\",\n                at: {\n                    gte: start,\n                    lte: end\n                }\n            }\n        }\n    });\n    const outflows = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"OUT\",\n                at: {\n                    gte: start,\n                    lte: end\n                }\n            }\n        }\n    });\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        select: {\n            id: true,\n            name: true,\n            protected: true,\n            active: true\n        }\n    });\n    const mapIn = new Map(inflows.map((i)=>[\n            i.envelopeId,\n            i._sum.amount ?? 0\n        ]));\n    const mapOut = new Map(outflows.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    return envs.map((e)=>{\n        const inflow = mapIn.get(e.id) ?? 0;\n        const outflow = mapOut.get(e.id) ?? 0;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            protected: e.protected,\n            active: e.active,\n            inflow,\n            outflow,\n            delta: inflow - outflow\n        };\n    }).sort((a, b)=>a.name.localeCompare(b.name));\n}\nfunction toCSV(rows, headers) {\n    if (!rows.length) return \"\";\n    const cols = headers ?? Object.keys(rows[0]);\n    const esc = (v)=>{\n        const s = String(v ?? \"\");\n        return /[\",\\n]/.test(s) ? `\"${s.replace(/\"/g, '\"\"')}\"` : s;\n    };\n    const out = [\n        cols.join(\",\")\n    ];\n    for (const r of rows)out.push(cols.map((c)=>esc(r[c])).join(\",\"));\n    return out.join(\"\\n\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvcXVlcmllcy9yZXBvcnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBc0M7QUFHdEMsU0FBU0MsV0FBV0MsUUFBZ0IsRUFBRUMsTUFBYztJQUNsRCxPQUFPO1FBQUVDLE9BQU8sSUFBSUMsS0FBS0gsV0FBVztRQUFtQkksS0FBSyxJQUFJRCxLQUFLRixTQUFTO0lBQWtCO0FBQ2xHO0FBRU8sZUFBZUksd0JBQXdCQyxDQUF1STtJQUNuTCxNQUFNLEVBQUVKLEtBQUssRUFBRUUsR0FBRyxFQUFFLEdBQUdMLFdBQVdPLEVBQUVKLEtBQUssRUFBRUksRUFBRUYsR0FBRztJQUNoRCxNQUFNRyxRQUFhO1FBQUVDLElBQUk7WUFBRUMsS0FBS1A7WUFBT1EsS0FBS047UUFBSTtJQUFFO0lBQ2xELElBQUdFLEVBQUVLLElBQUksRUFBRUosTUFBTUssSUFBSSxHQUFDTixFQUFFSyxJQUFJO0lBQUUsSUFBR0wsRUFBRU8sU0FBUyxFQUFFTixNQUFNTSxTQUFTLEdBQUNQLEVBQUVPLFNBQVM7SUFDekUsTUFBTUMsZUFBZSxDQUFDLENBQUNSLEVBQUVTLFVBQVUsSUFBSVIsTUFBTUssSUFBSSxLQUFHLFNBQVNMLE1BQU1LLElBQUksS0FBRyxVQUFVLENBQUNMLE1BQU1LLElBQUk7SUFDL0YsTUFBTUksTUFBTSxNQUFNbEIsK0NBQU1BLENBQUNtQixXQUFXLENBQUNDLFFBQVEsQ0FBQztRQUM1Q1g7UUFDQVksU0FBU0wsZUFBZTtZQUFFTSxRQUFRZCxFQUFFUyxVQUFVLEdBQUc7Z0JBQUVSLE9BQU87b0JBQUVRLFlBQVlULEVBQUVTLFVBQVU7Z0JBQUM7Z0JBQUdJLFNBQVM7b0JBQUVFLFVBQVU7Z0JBQUs7WUFBRSxJQUFJO2dCQUFFRixTQUFTO29CQUFFRSxVQUFVO2dCQUFLO1lBQUU7UUFBRSxJQUFJQztRQUM1SkMsU0FBUztZQUFFZixJQUFJO1FBQU07UUFDckJnQixNQUFNbEIsRUFBRW1CLEtBQUs7UUFDYkMsTUFBTXBC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LE1BQUksQ0FBQ0M7UUFBVSxNQUFNQyxJQUFFQyxPQUFPRixLQUFHO1FBQUssT0FBTyxTQUFTRyxJQUFJLENBQUNGLEtBQUcsQ0FBQyxDQUFDLEVBQUVBLEVBQUVHLE9BQU8sQ0FBQyxNQUFLLE1BQU0sQ0FBQyxDQUFDLEdBQUNIO0lBQUc7SUFDbkcsTUFBTUksTUFBSTtRQUFDVCxLQUFLVSxJQUFJLENBQUM7S0FBSztJQUFFLEtBQUksTUFBTUMsS0FBS2QsS0FBTVksSUFBSUcsSUFBSSxDQUFDWixLQUFLdEMsR0FBRyxDQUFDbUQsQ0FBQUEsSUFBR1YsSUFBSVEsQ0FBQyxDQUFDRSxFQUFFLEdBQUdILElBQUksQ0FBQztJQUFPLE9BQU9ELElBQUlDLElBQUksQ0FBQztBQUMvRyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcc2VydmVyXFxxdWVyaWVzXFxyZXBvcnRzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmltcG9ydCB0eXBlIHsgVHJhbnNhY3Rpb25Sb3csIEVudmVsb3BlRXhlY3V0aW9uUm93LCBBbGxvY2F0aW9uIH0gZnJvbSBcIkAvc2VydmVyL3R5cGVzXCI7XG5cbmZ1bmN0aW9uIHBhcnNlUmFuZ2Uoc3RhcnRTdHI6IHN0cmluZywgZW5kU3RyOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHsgc3RhcnQ6IG5ldyBEYXRlKHN0YXJ0U3RyICsgXCJUMDA6MDA6MDAuMDAwWlwiKSwgZW5kOiBuZXcgRGF0ZShlbmRTdHIgKyBcIlQyMzo1OTo1OS45OTlaXCIpIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFRyYW5zYWN0aW9uc1JlcG9ydChwOiB7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nOyB0eXBlPzogXCJJTlwiIHwgXCJPVVRcIiB8IFwiRElTVFwiOyBlbnZlbG9wZUlkPzogc3RyaW5nOyBzZXJ2aWNlSWQ/OiBzdHJpbmc7IGxpbWl0OiBudW1iZXI7IG9mZnNldDogbnVtYmVyIH0pOiBQcm9taXNlPFRyYW5zYWN0aW9uUm93W10+IHtcbiAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSBwYXJzZVJhbmdlKHAuc3RhcnQsIHAuZW5kKTtcbiAgY29uc3Qgd2hlcmU6IGFueSA9IHsgYXQ6IHsgZ3RlOiBzdGFydCwgbHRlOiBlbmQgfSB9O1xuICBpZihwLnR5cGUpIHdoZXJlLmtpbmQ9cC50eXBlOyBpZihwLnNlcnZpY2VJZCkgd2hlcmUuc2VydmljZUlkPXAuc2VydmljZUlkO1xuICBjb25zdCBpbmNsdWRlQWxsb2MgPSAhIXAuZW52ZWxvcGVJZCB8fCB3aGVyZS5raW5kPT09XCJPVVRcIiB8fCB3aGVyZS5raW5kPT09XCJESVNUXCIgfHwgIXdoZXJlLmtpbmQ7XG4gIGNvbnN0IHR4cyA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbi5maW5kTWFueSh7XG4gICAgd2hlcmUsXG4gICAgaW5jbHVkZTogaW5jbHVkZUFsbG9jID8geyBhbGxvY3M6IHAuZW52ZWxvcGVJZCA/IHsgd2hlcmU6IHsgZW52ZWxvcGVJZDogcC5lbnZlbG9wZUlkIH0sIGluY2x1ZGU6IHsgZW52ZWxvcGU6IHRydWUgfSB9IDogeyBpbmNsdWRlOiB7IGVudmVsb3BlOiB0cnVlIH0gfSB9IDogdW5kZWZpbmVkLFxuICAgIG9yZGVyQnk6IHsgYXQ6IFwiYXNjXCIgfSxcbiAgICB0YWtlOiBwLmxpbWl0LFxuICAgIHNraXA6IHAub2Zmc2V0LFxuICB9KTtcblxuICByZXR1cm4gdHhzLm1hcCgodCkgPT4ge1xuICAgIGNvbnN0IHJhd0FsbG9jcyA9ICh0IGFzIGFueSkuYWxsb2NzIGFzICggeyBlbnZlbG9wZUlkOiBzdHJpbmc7IGVudmVsb3BlPzogeyBuYW1lPzogc3RyaW5nIH07IGFtb3VudDogbnVtYmVyIH1bXSB8IHVuZGVmaW5lZCkgPz8gW107XG4gICAgY29uc3QgYWxsb2NhdGlvbnM6IEFsbG9jYXRpb25bXSA9IHJhd0FsbG9jcy5tYXAoKGEpID0+ICh7IGVudmVsb3BlSWQ6IGEuZW52ZWxvcGVJZCwgZW52ZWxvcGVOYW1lOiBhLmVudmVsb3BlPy5uYW1lID8/IFwiXCIsIGFtb3VudDogYS5hbW91bnQgfSkpO1xuICAgIHJldHVybiB7IGlkOiB0LmlkLCBraW5kOiB0LmtpbmQgYXMgXCJJTlwiIHwgXCJPVVRcIiB8IFwiRElTVFwiLCBsYWJlbDogdC5sYWJlbCA/PyBudWxsLCBhbW91bnQ6IHQuYW1vdW50LCBhdDogdC5hdCwgc2VydmljZUlkOiB0LnNlcnZpY2VJZCA/PyBudWxsLCBhbGxvY2F0aW9ucyB9O1xuICB9KTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEVudmVsb3BlRXhlY3V0aW9uKHA6e3N0YXJ0OnN0cmluZztlbmQ6c3RyaW5nfSl7XG4gIGNvbnN0IHsgc3RhcnQsIGVuZCB9ID0gcGFyc2VSYW5nZShwLnN0YXJ0LCBwLmVuZCk7XG4gIGNvbnN0IGluZmxvd3MgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoeyBieTogW1wiZW52ZWxvcGVJZFwiXSwgX3N1bTogeyBhbW91bnQ6IHRydWUgfSwgd2hlcmU6IHsgdHJhbnNhY3Rpb246IHsga2luZDogXCJESVNUXCIsIGF0OiB7IGd0ZTogc3RhcnQsIGx0ZTogZW5kIH0gfSB9IH0pO1xuICBjb25zdCBvdXRmbG93cyA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbkFsbG9jYXRpb24uZ3JvdXBCeSh7IGJ5OiBbXCJlbnZlbG9wZUlkXCJdLCBfc3VtOiB7IGFtb3VudDogdHJ1ZSB9LCB3aGVyZTogeyB0cmFuc2FjdGlvbjogeyBraW5kOiBcIk9VVFwiLCBhdDogeyBndGU6IHN0YXJ0LCBsdGU6IGVuZCB9IH0gfSB9KTtcbiAgY29uc3QgZW52cz1hd2FpdCBwcmlzbWEuZW52ZWxvcGUuZmluZE1hbnkoe3NlbGVjdDp7aWQ6dHJ1ZSxuYW1lOnRydWUscHJvdGVjdGVkOnRydWUsYWN0aXZlOnRydWV9fSk7XG4gIGNvbnN0IG1hcEluPW5ldyBNYXAoaW5mbG93cy5tYXAoaT0+W2kuZW52ZWxvcGVJZCxpLl9zdW0uYW1vdW50Pz8wXSkpOyBjb25zdCBtYXBPdXQ9bmV3IE1hcChvdXRmbG93cy5tYXAobz0+W28uZW52ZWxvcGVJZCxvLl9zdW0uYW1vdW50Pz8wXSkpO1xuICByZXR1cm4gZW52cy5tYXAoKGUpID0+IHsgY29uc3QgaW5mbG93ID0gbWFwSW4uZ2V0KGUuaWQpID8/IDA7IGNvbnN0IG91dGZsb3cgPSBtYXBPdXQuZ2V0KGUuaWQpID8/IDA7IHJldHVybiB7IGVudmVsb3BlSWQ6IGUuaWQsIG5hbWU6IGUubmFtZSwgcHJvdGVjdGVkOiBlLnByb3RlY3RlZCwgYWN0aXZlOiBlLmFjdGl2ZSwgaW5mbG93LCBvdXRmbG93LCBkZWx0YTogaW5mbG93IC0gb3V0ZmxvdyB9IGFzIEVudmVsb3BlRXhlY3V0aW9uUm93OyB9KS5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB0b0NTVihyb3dzOlJlY29yZDxzdHJpbmcsYW55PltdLCBoZWFkZXJzPzpzdHJpbmdbXSl7XG4gIGlmKCFyb3dzLmxlbmd0aCkgcmV0dXJuIFwiXCI7IGNvbnN0IGNvbHM9aGVhZGVycz8/T2JqZWN0LmtleXMocm93c1swXSk7XG4gIGNvbnN0IGVzYz0odjphbnkpPT57IGNvbnN0IHM9U3RyaW5nKHY/P1wiXCIpOyByZXR1cm4gL1tcIixcXG5dLy50ZXN0KHMpP2BcIiR7cy5yZXBsYWNlKC9cIi9nLCdcIlwiJyl9XCJgOnM7IH07XG4gIGNvbnN0IG91dD1bY29scy5qb2luKFwiLFwiKV07IGZvcihjb25zdCByIG9mIHJvd3MpIG91dC5wdXNoKGNvbHMubWFwKGM9PmVzYyhyW2NdKSkuam9pbihcIixcIikpOyByZXR1cm4gb3V0LmpvaW4oXCJcXG5cIik7XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwicGFyc2VSYW5nZSIsInN0YXJ0U3RyIiwiZW5kU3RyIiwic3RhcnQiLCJEYXRlIiwiZW5kIiwiZmV0Y2hUcmFuc2FjdGlvbnNSZXBvcnQiLCJwIiwid2hlcmUiLCJhdCIsImd0ZSIsImx0ZSIsInR5cGUiLCJraW5kIiwic2VydmljZUlkIiwiaW5jbHVkZUFsbG9jIiwiZW52ZWxvcGVJZCIsInR4cyIsInRyYW5zYWN0aW9uIiwiZmluZE1hbnkiLCJpbmNsdWRlIiwiYWxsb2NzIiwiZW52ZWxvcGUiLCJ1bmRlZmluZWQiLCJvcmRlckJ5IiwidGFrZSIsImxpbWl0Iiwic2tpcCIsIm9mZnNldCIsIm1hcCIsInQiLCJyYXdBbGxvY3MiLCJhbGxvY2F0aW9ucyIsImEiLCJlbnZlbG9wZU5hbWUiLCJuYW1lIiwiYW1vdW50IiwiaWQiLCJsYWJlbCIsImZldGNoRW52ZWxvcGVFeGVjdXRpb24iLCJpbmZsb3dzIiwidHJhbnNhY3Rpb25BbGxvY2F0aW9uIiwiZ3JvdXBCeSIsImJ5IiwiX3N1bSIsIm91dGZsb3dzIiwiZW52cyIsInNlbGVjdCIsInByb3RlY3RlZCIsImFjdGl2ZSIsIm1hcEluIiwiTWFwIiwiaSIsIm1hcE91dCIsIm8iLCJlIiwiaW5mbG93IiwiZ2V0Iiwib3V0ZmxvdyIsImRlbHRhIiwic29ydCIsImIiLCJsb2NhbGVDb21wYXJlIiwidG9DU1YiLCJyb3dzIiwiaGVhZGVycyIsImxlbmd0aCIsImNvbHMiLCJPYmplY3QiLCJrZXlzIiwiZXNjIiwidiIsInMiLCJTdHJpbmciLCJ0ZXN0IiwicmVwbGFjZSIsIm91dCIsImpvaW4iLCJyIiwicHVzaCIsImMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/queries/reports.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/validators/reports.ts":
/*!******************************************!*\
  !*** ./src/server/validators/reports.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DateRange: () => (/* binding */ DateRange),\n/* harmony export */   EnvelopeExecutionReportSchema: () => (/* binding */ EnvelopeExecutionReportSchema),\n/* harmony export */   TransactionsReportSchema: () => (/* binding */ TransactionsReportSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.23.8/node_modules/zod/lib/index.mjs\");\n\nconst DateRange = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    start: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().regex(/^\\d{4}-\\d{2}-\\d{2}$/),\n    end: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().regex(/^\\d{4}-\\d{2}-\\d{2}$/)\n});\nconst TransactionsReportSchema = DateRange.extend({\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.z.enum([\n        \"IN\",\n        \"OUT\",\n        \"DIST\"\n    ]).optional(),\n    envelopeId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    serviceId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().optional(),\n    limit: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(1).max(500).default(200),\n    offset: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().min(0).default(0)\n});\nconst EnvelopeExecutionReportSchema = DateRange;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvdmFsaWRhdG9ycy9yZXBvcnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBd0I7QUFDakIsTUFBTUMsWUFBWUQsa0NBQUNBLENBQUNFLE1BQU0sQ0FBQztJQUFFQyxPQUFNSCxrQ0FBQ0EsQ0FBQ0ksTUFBTSxHQUFHQyxLQUFLLENBQUM7SUFBd0JDLEtBQUlOLGtDQUFDQSxDQUFDSSxNQUFNLEdBQUdDLEtBQUssQ0FBQztBQUF1QixHQUFHO0FBQzNILE1BQU1FLDJCQUEyQk4sVUFBVU8sTUFBTSxDQUFDO0lBQUVDLE1BQUtULGtDQUFDQSxDQUFDVSxJQUFJLENBQUM7UUFBQztRQUFLO1FBQU07S0FBTyxFQUFFQyxRQUFRO0lBQUlDLFlBQVdaLGtDQUFDQSxDQUFDSSxNQUFNLEdBQUdPLFFBQVE7SUFBSUUsV0FBVWIsa0NBQUNBLENBQUNJLE1BQU0sR0FBR08sUUFBUTtJQUFJRyxPQUFNZCxrQ0FBQ0EsQ0FBQ2UsTUFBTSxHQUFHQyxHQUFHLEdBQUdDLEdBQUcsQ0FBQyxHQUFHQyxHQUFHLENBQUMsS0FBS0MsT0FBTyxDQUFDO0lBQU1DLFFBQU9wQixrQ0FBQ0EsQ0FBQ2UsTUFBTSxHQUFHQyxHQUFHLEdBQUdDLEdBQUcsQ0FBQyxHQUFHRSxPQUFPLENBQUM7QUFBRyxHQUFHO0FBQ3RRLE1BQU1FLGdDQUFnQ3BCLFVBQVUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxcdmFsaWRhdG9yc1xccmVwb3J0cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xuZXhwb3J0IGNvbnN0IERhdGVSYW5nZSA9IHoub2JqZWN0KHsgc3RhcnQ6ei5zdHJpbmcoKS5yZWdleCgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC8pLCBlbmQ6ei5zdHJpbmcoKS5yZWdleCgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9JC8pIH0pO1xuZXhwb3J0IGNvbnN0IFRyYW5zYWN0aW9uc1JlcG9ydFNjaGVtYSA9IERhdGVSYW5nZS5leHRlbmQoeyB0eXBlOnouZW51bShbXCJJTlwiLFwiT1VUXCIsXCJESVNUXCJdKS5vcHRpb25hbCgpLCBlbnZlbG9wZUlkOnouc3RyaW5nKCkub3B0aW9uYWwoKSwgc2VydmljZUlkOnouc3RyaW5nKCkub3B0aW9uYWwoKSwgbGltaXQ6ei5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDUwMCkuZGVmYXVsdCgyMDApLCBvZmZzZXQ6ei5udW1iZXIoKS5pbnQoKS5taW4oMCkuZGVmYXVsdCgwKSB9KTtcbmV4cG9ydCBjb25zdCBFbnZlbG9wZUV4ZWN1dGlvblJlcG9ydFNjaGVtYSA9IERhdGVSYW5nZTtcbiJdLCJuYW1lcyI6WyJ6IiwiRGF0ZVJhbmdlIiwib2JqZWN0Iiwic3RhcnQiLCJzdHJpbmciLCJyZWdleCIsImVuZCIsIlRyYW5zYWN0aW9uc1JlcG9ydFNjaGVtYSIsImV4dGVuZCIsInR5cGUiLCJlbnVtIiwib3B0aW9uYWwiLCJlbnZlbG9wZUlkIiwic2VydmljZUlkIiwibGltaXQiLCJudW1iZXIiLCJpbnQiLCJtaW4iLCJtYXgiLCJkZWZhdWx0Iiwib2Zmc2V0IiwiRW52ZWxvcGVFeGVjdXRpb25SZXBvcnRTY2hlbWEiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/validators/reports.ts\n");

/***/ })

};
;