"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_server_queries_envelopes_ts-_4d090";
exports.ids = ["_action-browser_src_server_queries_envelopes_ts-_4d090"];
exports.modules = {

/***/ "(action-browser)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = global.__prisma ??= new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) global.__prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQVN2QyxNQUFNQyxTQUFVQyxPQUFPQyxRQUFRLEtBQUssSUFBSUgsd0RBQVlBLEdBQUk7QUFDL0QsSUFBSUksSUFBcUMsRUFBRUYsT0FBT0MsUUFBUSxHQUFHRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcbGliXFxwcmlzbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG4vLyBFbnN1cmUgYSBzaW5nbGUgUHJpc21hQ2xpZW50IGluc3RhbmNlIGluIGRldmVsb3BtZW50IHRvIGF2b2lkIGV4aGF1c3Rpbmdcbi8vIGRhdGFiYXNlIGNvbm5lY3Rpb25zIGR1cmluZyBITVIgKHNlZSBQcmlzbWEgZG9jcykuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSAoZ2xvYmFsLl9fcHJpc21hID8/PSBuZXcgUHJpc21hQ2xpZW50KCkpO1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbC5fX3ByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJfX3ByaXNtYSIsInByb2Nlc3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/queries/envelopes.ts":
/*!*****************************************!*\
  !*** ./src/server/queries/envelopes.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllEnvelopeBalances: () => (/* binding */ getAllEnvelopeBalances),\n/* harmony export */   getBlockedEnvelopeCoverage: () => (/* binding */ getBlockedEnvelopeCoverage),\n/* harmony export */   getEnvelopeCoverageAll: () => (/* binding */ getEnvelopeCoverageAll)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(action-browser)/./src/lib/prisma.ts\");\n\nasync function getAllEnvelopeBalances() {\n    // Only consider active envelopes for balances shown in the app (dashboard, lists)\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true\n        },\n        select: {\n            id: true,\n            name: true,\n            protected: true,\n            active: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"DIST\"\n            }\n        }\n    });\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"OUT\"\n            }\n        }\n    });\n    const mapD = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const mapO = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    return envs.map((e)=>{\n        const inflow = mapD.get(e.id) ?? 0, outflow = mapO.get(e.id) ?? 0;\n        const total = typeof e.budgetTarget === 'number' ? e.budgetTarget : inflow;\n        const balance = total - outflow;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            protected: e.protected,\n            active: e.active,\n            emoji: e.emoji ?? null,\n            budgetTarget: e.budgetTarget ?? null,\n            inflow,\n            outflow,\n            balance\n        };\n    });\n}\n// Retourne la couverture (en mois) des enveloppes classées \"blocked\" ou protégées.\nasync function getBlockedEnvelopeCoverage() {\n    const now = new Date();\n    const daysWindow = 90; // use last 90 days to compute average\n    const since = new Date(now.getTime() - daysWindow * 24 * 3600 * 1000);\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true,\n            OR: [\n                {\n                    protected: true\n                },\n                {\n                    classification: 'blocked'\n                }\n            ]\n        },\n        select: {\n            id: true,\n            name: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    if (envs.length === 0) return [];\n    const ids = envs.map((e)=>e.id);\n    // sum of OUT amounts over the window\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT',\n                at: {\n                    gte: since\n                }\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outMap = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    // current balances using existing helper logic: inflow/outflow all-time\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'DIST'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outsAll = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const distMap = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const outsAllMap = new Map(outsAll.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const res = envs.map((e)=>{\n        const allocated = distMap.get(e.id) ?? 0;\n        const spentAll = outsAllMap.get(e.id) ?? 0;\n        const balance = (typeof e.budgetTarget === 'number' ? e.budgetTarget : allocated) - spentAll;\n        const outLast90 = outMap.get(e.id) ?? 0;\n        const avgMonthly = outLast90 / daysWindow * 30; // approximate month\n        const months = avgMonthly > 0 ? Number((balance / avgMonthly).toFixed(1)) : balance > 0 ? Infinity : 0;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            emoji: e.emoji ?? null,\n            balance,\n            avgMonthly: Math.round(avgMonthly),\n            monthsCoverage: months\n        };\n    });\n    return res;\n}\n// Retourne la couverture (en mois) pour toutes les enveloppes actives.\nasync function getEnvelopeCoverageAll(options) {\n    const daysWindow = options?.daysWindow ?? 90;\n    const now = new Date();\n    const since = new Date(now.getTime() - daysWindow * 24 * 3600 * 1000);\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true\n        },\n        select: {\n            id: true,\n            name: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    if (envs.length === 0) return [];\n    const ids = envs.map((e)=>e.id);\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT',\n                at: {\n                    gte: since\n                }\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outMap = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'DIST'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outsAll = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const distMap = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const outsAllMap = new Map(outsAll.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const res = envs.map((e)=>{\n        const allocated = distMap.get(e.id) ?? 0;\n        const spentAll = outsAllMap.get(e.id) ?? 0;\n        const balance = (typeof e.budgetTarget === 'number' ? e.budgetTarget : allocated) - spentAll;\n        const outLast = outMap.get(e.id) ?? 0;\n        const avgMonthly = outLast / daysWindow * 30;\n        const months = avgMonthly > 0 ? Number((balance / avgMonthly).toFixed(1)) : balance > 0 ? Infinity : 0;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            emoji: e.emoji ?? null,\n            balance,\n            avgMonthly: Math.round(avgMonthly),\n            monthsCoverage: months\n        };\n    });\n    return res;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvcXVlcmllcy9lbnZlbG9wZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzQztBQUMvQixlQUFlQztJQUNwQixrRkFBa0Y7SUFDbEYsTUFBTUMsT0FBSyxNQUFNRiwrQ0FBTUEsQ0FBQ0csUUFBUSxDQUFDQyxRQUFRLENBQUM7UUFBRUMsT0FBTztZQUFFQyxRQUFRO1FBQUs7UUFBR0MsUUFBTztZQUFDQyxJQUFHO1lBQUtDLE1BQUs7WUFBS0MsV0FBVTtZQUFLSixRQUFPO1lBQU1LLE9BQU07WUFBTUMsY0FBYTtRQUFJO0lBQUM7SUFDekosTUFBTUMsT0FBSyxNQUFNYiwrQ0FBTUEsQ0FBQ2MscUJBQXFCLENBQUNDLE9BQU8sQ0FBQztRQUFDQyxJQUFHO1lBQUM7U0FBYTtRQUFFQyxNQUFLO1lBQUNDLFFBQU87UUFBSTtRQUFHYixPQUFNO1lBQUNjLGFBQVk7Z0JBQUNDLE1BQUs7WUFBTTtRQUFDO0lBQUM7SUFDL0gsTUFBTUMsT0FBSyxNQUFNckIsK0NBQU1BLENBQUNjLHFCQUFxQixDQUFDQyxPQUFPLENBQUM7UUFBQ0MsSUFBRztZQUFDO1NBQWE7UUFBRUMsTUFBSztZQUFDQyxRQUFPO1FBQUk7UUFBR2IsT0FBTTtZQUFDYyxhQUFZO2dCQUFDQyxNQUFLO1lBQUs7UUFBQztJQUFDO0lBQzlILE1BQU1FLE9BQUssSUFBSUMsSUFBSVYsS0FBS1csR0FBRyxDQUFDQyxDQUFBQSxJQUFHO1lBQUNBLEVBQUVDLFVBQVU7WUFBRUQsRUFBRVIsSUFBSSxDQUFDQyxNQUFNLElBQUU7U0FBRTtJQUFJLE1BQU1TLE9BQUssSUFBSUosSUFBSUYsS0FBS0csR0FBRyxDQUFDSSxDQUFBQSxJQUFHO1lBQUNBLEVBQUVGLFVBQVU7WUFBRUUsRUFBRVgsSUFBSSxDQUFDQyxNQUFNLElBQUU7U0FBRTtJQUNsSSxPQUFPaEIsS0FBS3NCLEdBQUcsQ0FBQ0ssQ0FBQUE7UUFBSyxNQUFNQyxTQUFPUixLQUFLUyxHQUFHLENBQUNG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LElBQUksQ0FBQ0MsTUFBTSxJQUFJO1NBQUU7SUFDdEUsTUFBTWlDLGFBQWEsSUFBSTVCLElBQUkwQixRQUFRekIsR0FBRyxDQUFDSSxDQUFBQSxJQUFHO1lBQUNBLEVBQUVGLFVBQVU7WUFBRUUsRUFBRVgsSUFBSSxDQUFDQyxNQUFNLElBQUk7U0FBRTtJQUU1RSxNQUFNa0MsTUFBTWxELEtBQUtzQixHQUFHLENBQUNLLENBQUFBO1FBQ25CLE1BQU13QixZQUFZSCxRQUFRbkIsR0FBRyxDQUFDRixFQUFFckIsRUFBRSxLQUFLO1FBQ3ZDLE1BQU04QyxXQUFXSCxXQUFXcEIsR0FBRyxDQUFDRixFQUFFckIsRUFBRSxLQUFLO1FBQ3pDLE1BQU0wQixVQUFVLENBQUMsT0FBT0wsRUFBRWpCLFlBQVksS0FBSyxXQUFXaUIsRUFBRWpCLFlBQVksR0FBR3lDLFNBQVEsSUFBS0M7UUFDcEYsTUFBTVksVUFBVWxCLE9BQU9qQixHQUFHLENBQUNGLEVBQUVyQixFQUFFLEtBQUs7UUFDcEMsTUFBTWdELGFBQWFVLFVBQVU1QixhQUFhO1FBQzFDLE1BQU1tQixTQUFTRCxhQUFhLElBQUlFLE9BQU8sQ0FBQ3hCLFVBQVVzQixVQUFTLEVBQUdHLE9BQU8sQ0FBQyxNQUFPekIsVUFBVSxJQUFJMEIsV0FBVztRQUN0RyxPQUFPO1lBQUVsQyxZQUFZRyxFQUFFckIsRUFBRTtZQUFFQyxNQUFNb0IsRUFBRXBCLElBQUk7WUFBRUUsT0FBT2tCLEVBQUVsQixLQUFLLElBQUk7WUFBTXVCO1lBQVNzQixZQUFZSyxLQUFLQyxLQUFLLENBQUNOO1lBQWFPLGdCQUFnQk47UUFBTztJQUN2STtJQUVBLE9BQU9MO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxccXVlcmllc1xcZW52ZWxvcGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxFbnZlbG9wZUJhbGFuY2VzKCl7XG4gIC8vIE9ubHkgY29uc2lkZXIgYWN0aXZlIGVudmVsb3BlcyBmb3IgYmFsYW5jZXMgc2hvd24gaW4gdGhlIGFwcCAoZGFzaGJvYXJkLCBsaXN0cylcbiAgY29uc3QgZW52cz1hd2FpdCBwcmlzbWEuZW52ZWxvcGUuZmluZE1hbnkoeyB3aGVyZTogeyBhY3RpdmU6IHRydWUgfSwgc2VsZWN0OntpZDp0cnVlLG5hbWU6dHJ1ZSxwcm90ZWN0ZWQ6dHJ1ZSxhY3RpdmU6dHJ1ZSwgZW1vamk6dHJ1ZSwgYnVkZ2V0VGFyZ2V0OnRydWV9fSk7XG4gIGNvbnN0IGRpc3Q9YXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtieTpbXCJlbnZlbG9wZUlkXCJdLCBfc3VtOnthbW91bnQ6dHJ1ZX0sIHdoZXJlOnt0cmFuc2FjdGlvbjp7a2luZDpcIkRJU1RcIn19fSk7XG4gIGNvbnN0IG91dHM9YXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtieTpbXCJlbnZlbG9wZUlkXCJdLCBfc3VtOnthbW91bnQ6dHJ1ZX0sIHdoZXJlOnt0cmFuc2FjdGlvbjp7a2luZDpcIk9VVFwifX19KTtcbiAgY29uc3QgbWFwRD1uZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQ/PzBdKSk7IGNvbnN0IG1hcE89bmV3IE1hcChvdXRzLm1hcChvPT5bby5lbnZlbG9wZUlkLCBvLl9zdW0uYW1vdW50Pz8wXSkpO1xuICByZXR1cm4gZW52cy5tYXAoZT0+eyBjb25zdCBpbmZsb3c9bWFwRC5nZXQoZS5pZCk/PzAsIG91dGZsb3c9bWFwTy5nZXQoZS5pZCk/PzA7IGNvbnN0IHRvdGFsID0gdHlwZW9mIGUuYnVkZ2V0VGFyZ2V0ID09PSAnbnVtYmVyJyA/IGUuYnVkZ2V0VGFyZ2V0IDogaW5mbG93OyBjb25zdCBiYWxhbmNlID0gdG90YWwgLSBvdXRmbG93OyByZXR1cm4geyBlbnZlbG9wZUlkOmUuaWQsIG5hbWU6ZS5uYW1lLCBwcm90ZWN0ZWQ6ZS5wcm90ZWN0ZWQsIGFjdGl2ZTplLmFjdGl2ZSwgZW1vamk6IGUuZW1vamkgPz8gbnVsbCwgYnVkZ2V0VGFyZ2V0OiBlLmJ1ZGdldFRhcmdldCA/PyBudWxsLCBpbmZsb3csIG91dGZsb3csIGJhbGFuY2UgfTsgfSk7XG59XG5cbi8vIFJldG91cm5lIGxhIGNvdXZlcnR1cmUgKGVuIG1vaXMpIGRlcyBlbnZlbG9wcGVzIGNsYXNzw6llcyBcImJsb2NrZWRcIiBvdSBwcm90w6lnw6llcy5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRCbG9ja2VkRW52ZWxvcGVDb3ZlcmFnZSgpe1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBkYXlzV2luZG93ID0gOTA7IC8vIHVzZSBsYXN0IDkwIGRheXMgdG8gY29tcHV0ZSBhdmVyYWdlXG4gIGNvbnN0IHNpbmNlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIGRheXNXaW5kb3cgKiAyNCAqIDM2MDAgKiAxMDAwKTtcblxuICBjb25zdCBlbnZzID0gYXdhaXQgcHJpc21hLmVudmVsb3BlLmZpbmRNYW55KHsgd2hlcmU6IHsgYWN0aXZlOiB0cnVlLCBPUjogW3sgcHJvdGVjdGVkOiB0cnVlIH0sIHsgY2xhc3NpZmljYXRpb246ICdibG9ja2VkJyB9XSB9LCBzZWxlY3Q6IHsgaWQ6dHJ1ZSwgbmFtZTp0cnVlLCBlbW9qaTp0cnVlLCBidWRnZXRUYXJnZXQ6dHJ1ZSB9IH0pO1xuICBpZihlbnZzLmxlbmd0aD09PTApIHJldHVybiBbXSBhcyBhbnlbXTtcblxuICBjb25zdCBpZHMgPSBlbnZzLm1hcChlPT5lLmlkKTtcblxuICAvLyBzdW0gb2YgT1VUIGFtb3VudHMgb3ZlciB0aGUgd2luZG93XG4gIGNvbnN0IG91dHMgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoe1xuICAgIGJ5OiBbJ2VudmVsb3BlSWQnXSxcbiAgICB3aGVyZTogeyBlbnZlbG9wZUlkOiB7IGluOiBpZHMgfSwgdHJhbnNhY3Rpb246IHsga2luZDogJ09VVCcsIGF0OiB7IGd0ZTogc2luY2UgfSB9IH0sXG4gICAgX3N1bTogeyBhbW91bnQ6IHRydWUgfVxuICB9KTtcblxuICBjb25zdCBvdXRNYXAgPSBuZXcgTWFwKG91dHMubWFwKG89PltvLmVudmVsb3BlSWQsIG8uX3N1bS5hbW91bnQgPz8gMF0pKTtcblxuICAvLyBjdXJyZW50IGJhbGFuY2VzIHVzaW5nIGV4aXN0aW5nIGhlbHBlciBsb2dpYzogaW5mbG93L291dGZsb3cgYWxsLXRpbWVcbiAgY29uc3QgZGlzdCA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbkFsbG9jYXRpb24uZ3JvdXBCeSh7IGJ5OiBbJ2VudmVsb3BlSWQnXSwgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdESVNUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IG91dHNBbGwgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoeyBieTogWydlbnZlbG9wZUlkJ10sIHdoZXJlOiB7IGVudmVsb3BlSWQ6IHsgaW46IGlkcyB9LCB0cmFuc2FjdGlvbjogeyBraW5kOiAnT1VUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IGRpc3RNYXAgPSBuZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQgPz8gMF0pKTtcbiAgY29uc3Qgb3V0c0FsbE1hcCA9IG5ldyBNYXAob3V0c0FsbC5tYXAobz0+W28uZW52ZWxvcGVJZCwgby5fc3VtLmFtb3VudCA/PyAwXSkpO1xuXG4gIGNvbnN0IHJlcyA9IGVudnMubWFwKGU9PntcbiAgICBjb25zdCBhbGxvY2F0ZWQgPSBkaXN0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IHNwZW50QWxsID0gb3V0c0FsbE1hcC5nZXQoZS5pZCkgPz8gMDtcbiAgICBjb25zdCBiYWxhbmNlID0gKHR5cGVvZiBlLmJ1ZGdldFRhcmdldCA9PT0gJ251bWJlcicgPyBlLmJ1ZGdldFRhcmdldCA6IGFsbG9jYXRlZCkgLSBzcGVudEFsbDtcbiAgICBjb25zdCBvdXRMYXN0OTAgPSBvdXRNYXAuZ2V0KGUuaWQpID8/IDA7XG4gICAgY29uc3QgYXZnTW9udGhseSA9IG91dExhc3Q5MCAvIGRheXNXaW5kb3cgKiAzMDsgLy8gYXBwcm94aW1hdGUgbW9udGhcbiAgICBjb25zdCBtb250aHMgPSBhdmdNb250aGx5ID4gMCA/IE51bWJlcigoYmFsYW5jZSAvIGF2Z01vbnRobHkpLnRvRml4ZWQoMSkpIDogKGJhbGFuY2UgPiAwID8gSW5maW5pdHkgOiAwKTtcbiAgICByZXR1cm4geyBlbnZlbG9wZUlkOiBlLmlkLCBuYW1lOiBlLm5hbWUsIGVtb2ppOiBlLmVtb2ppID8/IG51bGwsIGJhbGFuY2UsIGF2Z01vbnRobHk6IE1hdGgucm91bmQoYXZnTW9udGhseSksIG1vbnRoc0NvdmVyYWdlOiBtb250aHMgfTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlcztcbn1cblxuLy8gUmV0b3VybmUgbGEgY291dmVydHVyZSAoZW4gbW9pcykgcG91ciB0b3V0ZXMgbGVzIGVudmVsb3BwZXMgYWN0aXZlcy5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbnZlbG9wZUNvdmVyYWdlQWxsKG9wdGlvbnM/OiB7IGRheXNXaW5kb3c/OiBudW1iZXIgfSl7XG4gIGNvbnN0IGRheXNXaW5kb3cgPSBvcHRpb25zPy5kYXlzV2luZG93ID8/IDkwO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBzaW5jZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSBkYXlzV2luZG93ICogMjQgKiAzNjAwICogMTAwMCk7XG5cbiAgY29uc3QgZW52cyA9IGF3YWl0IHByaXNtYS5lbnZlbG9wZS5maW5kTWFueSh7IHdoZXJlOiB7IGFjdGl2ZTogdHJ1ZSB9LCBzZWxlY3Q6IHsgaWQ6dHJ1ZSwgbmFtZTp0cnVlLCBlbW9qaTp0cnVlLCBidWRnZXRUYXJnZXQ6dHJ1ZSB9IH0pO1xuICBpZihlbnZzLmxlbmd0aD09PTApIHJldHVybiBbXSBhcyBhbnlbXTtcblxuICBjb25zdCBpZHMgPSBlbnZzLm1hcChlPT5lLmlkKTtcblxuICBjb25zdCBvdXRzID0gYXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtcbiAgICBieTogWydlbnZlbG9wZUlkJ10sXG4gICAgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdPVVQnLCBhdDogeyBndGU6IHNpbmNlIH0gfSB9LFxuICAgIF9zdW06IHsgYW1vdW50OiB0cnVlIH1cbiAgfSk7XG5cbiAgY29uc3Qgb3V0TWFwID0gbmV3IE1hcChvdXRzLm1hcChvPT5bby5lbnZlbG9wZUlkLCBvLl9zdW0uYW1vdW50ID8/IDBdKSk7XG5cbiAgY29uc3QgZGlzdCA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbkFsbG9jYXRpb24uZ3JvdXBCeSh7IGJ5OiBbJ2VudmVsb3BlSWQnXSwgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdESVNUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IG91dHNBbGwgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoeyBieTogWydlbnZlbG9wZUlkJ10sIHdoZXJlOiB7IGVudmVsb3BlSWQ6IHsgaW46IGlkcyB9LCB0cmFuc2FjdGlvbjogeyBraW5kOiAnT1VUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IGRpc3RNYXAgPSBuZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQgPz8gMF0pKTtcbiAgY29uc3Qgb3V0c0FsbE1hcCA9IG5ldyBNYXAob3V0c0FsbC5tYXAobz0+W28uZW52ZWxvcGVJZCwgby5fc3VtLmFtb3VudCA/PyAwXSkpO1xuXG4gIGNvbnN0IHJlcyA9IGVudnMubWFwKGU9PntcbiAgICBjb25zdCBhbGxvY2F0ZWQgPSBkaXN0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IHNwZW50QWxsID0gb3V0c0FsbE1hcC5nZXQoZS5pZCkgPz8gMDtcbiAgICBjb25zdCBiYWxhbmNlID0gKHR5cGVvZiBlLmJ1ZGdldFRhcmdldCA9PT0gJ251bWJlcicgPyBlLmJ1ZGdldFRhcmdldCA6IGFsbG9jYXRlZCkgLSBzcGVudEFsbDtcbiAgICBjb25zdCBvdXRMYXN0ID0gb3V0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IGF2Z01vbnRobHkgPSBvdXRMYXN0IC8gZGF5c1dpbmRvdyAqIDMwO1xuICAgIGNvbnN0IG1vbnRocyA9IGF2Z01vbnRobHkgPiAwID8gTnVtYmVyKChiYWxhbmNlIC8gYXZnTW9udGhseSkudG9GaXhlZCgxKSkgOiAoYmFsYW5jZSA+IDAgPyBJbmZpbml0eSA6IDApO1xuICAgIHJldHVybiB7IGVudmVsb3BlSWQ6IGUuaWQsIG5hbWU6IGUubmFtZSwgZW1vamk6IGUuZW1vamkgPz8gbnVsbCwgYmFsYW5jZSwgYXZnTW9udGhseTogTWF0aC5yb3VuZChhdmdNb250aGx5KSwgbW9udGhzQ292ZXJhZ2U6IG1vbnRocyB9O1xuICB9KTtcblxuICByZXR1cm4gcmVzO1xufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImdldEFsbEVudmVsb3BlQmFsYW5jZXMiLCJlbnZzIiwiZW52ZWxvcGUiLCJmaW5kTWFueSIsIndoZXJlIiwiYWN0aXZlIiwic2VsZWN0IiwiaWQiLCJuYW1lIiwicHJvdGVjdGVkIiwiZW1vamkiLCJidWRnZXRUYXJnZXQiLCJkaXN0IiwidHJhbnNhY3Rpb25BbGxvY2F0aW9uIiwiZ3JvdXBCeSIsImJ5IiwiX3N1bSIsImFtb3VudCIsInRyYW5zYWN0aW9uIiwia2luZCIsIm91dHMiLCJtYXBEIiwiTWFwIiwibWFwIiwiZCIsImVudmVsb3BlSWQiLCJtYXBPIiwibyIsImUiLCJpbmZsb3ciLCJnZXQiLCJvdXRmbG93IiwidG90YWwiLCJiYWxhbmNlIiwiZ2V0QmxvY2tlZEVudmVsb3BlQ292ZXJhZ2UiLCJub3ciLCJEYXRlIiwiZGF5c1dpbmRvdyIsInNpbmNlIiwiZ2V0VGltZSIsIk9SIiwiY2xhc3NpZmljYXRpb24iLCJsZW5ndGgiLCJpZHMiLCJpbiIsImF0IiwiZ3RlIiwib3V0TWFwIiwib3V0c0FsbCIsImRpc3RNYXAiLCJvdXRzQWxsTWFwIiwicmVzIiwiYWxsb2NhdGVkIiwic3BlbnRBbGwiLCJvdXRMYXN0OTAiLCJhdmdNb250aGx5IiwibW9udGhzIiwiTnVtYmVyIiwidG9GaXhlZCIsIkluZmluaXR5IiwiTWF0aCIsInJvdW5kIiwibW9udGhzQ292ZXJhZ2UiLCJnZXRFbnZlbG9wZUNvdmVyYWdlQWxsIiwib3B0aW9ucyIsIm91dExhc3QiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/queries/envelopes.ts\n");

/***/ })

};
;