"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_action-browser_src_server_actions_transactions_ts";
exports.ids = ["_action-browser_src_server_actions_transactions_ts"];
exports.modules = {

/***/ "(action-browser)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentRole: () => (/* binding */ getCurrentRole),\n/* harmony export */   requireRole: () => (/* binding */ requireRole)\n/* harmony export */ });\n/* harmony import */ var _clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @clerk/nextjs/server */ \"(action-browser)/./node_modules/.pnpm/@clerk+nextjs@5.3.1_next@15_20ea36d09dc70bbbcc56b8a0d9ae486b/node_modules/@clerk/nextjs/dist/esm/app-router/server/auth.js\");\n\nasync function getCurrentRole() {\n    if (process.env.E2E_ROLE === \"operator\" || process.env.E2E_ROLE === \"manager\" || process.env.E2E_ROLE === \"auditor\") return process.env.E2E_ROLE;\n    const { userId, sessionClaims } = (0,_clerk_nextjs_server__WEBPACK_IMPORTED_MODULE_0__.auth)();\n    if (!userId) throw new Error(\"Unauthenticated\");\n    return sessionClaims?.role ?? \"operator\";\n}\nasync function requireRole(allowed) {\n    const role = await getCurrentRole();\n    if (!allowed.includes(role)) throw new Error(\"Forbidden\");\n    return role;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNEM7QUFFckMsZUFBZUM7SUFDcEIsSUFBSUMsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssY0FBY0YsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssYUFBYUYsUUFBUUMsR0FBRyxDQUFDQyxRQUFRLEtBQUssV0FBVyxPQUFPRixRQUFRQyxHQUFHLENBQUNDLFFBQVE7SUFDaEosTUFBTSxFQUFFQyxNQUFNLEVBQUVDLGFBQWEsRUFBRSxHQUFHTiwwREFBSUE7SUFBSSxJQUFJLENBQUNLLFFBQVEsTUFBTSxJQUFJRSxNQUFNO0lBQ3ZFLE9BQU8sZUFBZ0JDLFFBQTZCO0FBQ3REO0FBQ08sZUFBZUMsWUFBWUMsT0FBZTtJQUFJLE1BQU1GLE9BQU8sTUFBTVA7SUFBa0IsSUFBSSxDQUFDUyxRQUFRQyxRQUFRLENBQUNILE9BQU8sTUFBTSxJQUFJRCxNQUFNO0lBQWMsT0FBT0M7QUFBTSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcbGliXFxhdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGF1dGggfSBmcm9tIFwiQGNsZXJrL25leHRqcy9zZXJ2ZXJcIjtcbmV4cG9ydCB0eXBlIFJvbGUgPSBcIm9wZXJhdG9yXCIgfCBcIm1hbmFnZXJcIiB8IFwiYXVkaXRvclwiO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRSb2xlKCk6IFByb21pc2U8Um9sZT4ge1xuICBpZiAocHJvY2Vzcy5lbnYuRTJFX1JPTEUgPT09IFwib3BlcmF0b3JcIiB8fCBwcm9jZXNzLmVudi5FMkVfUk9MRSA9PT0gXCJtYW5hZ2VyXCIgfHwgcHJvY2Vzcy5lbnYuRTJFX1JPTEUgPT09IFwiYXVkaXRvclwiKSByZXR1cm4gcHJvY2Vzcy5lbnYuRTJFX1JPTEUgYXMgUm9sZTtcbiAgY29uc3QgeyB1c2VySWQsIHNlc3Npb25DbGFpbXMgfSA9IGF1dGgoKTsgaWYgKCF1c2VySWQpIHRocm93IG5ldyBFcnJvcihcIlVuYXV0aGVudGljYXRlZFwiKTtcbiAgcmV0dXJuIChzZXNzaW9uQ2xhaW1zPy5yb2xlIGFzIFJvbGUgfCB1bmRlZmluZWQpID8/IFwib3BlcmF0b3JcIjtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1aXJlUm9sZShhbGxvd2VkOiBSb2xlW10pIHsgY29uc3Qgcm9sZSA9IGF3YWl0IGdldEN1cnJlbnRSb2xlKCk7IGlmICghYWxsb3dlZC5pbmNsdWRlcyhyb2xlKSkgdGhyb3cgbmV3IEVycm9yKFwiRm9yYmlkZGVuXCIpOyByZXR1cm4gcm9sZTsgfVxuIl0sIm5hbWVzIjpbImF1dGgiLCJnZXRDdXJyZW50Um9sZSIsInByb2Nlc3MiLCJlbnYiLCJFMkVfUk9MRSIsInVzZXJJZCIsInNlc3Npb25DbGFpbXMiLCJFcnJvciIsInJvbGUiLCJyZXF1aXJlUm9sZSIsImFsbG93ZWQiLCJpbmNsdWRlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(action-browser)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst prisma = global.__prisma ??= new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) global.__prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQVN2QyxNQUFNQyxTQUFVQyxPQUFPQyxRQUFRLEtBQUssSUFBSUgsd0RBQVlBLEdBQUk7QUFDL0QsSUFBSUksSUFBcUMsRUFBRUYsT0FBT0MsUUFBUSxHQUFHRiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxCQzI0MVxcTXVzaWNcXGZpbmFuY2UtYXBwLXYxLW1haW5cXGZpbmFuY2UtYXBwLXYxLW1haW5cXHNyY1xcbGliXFxwcmlzbWEudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQnO1xuXG4vLyBFbnN1cmUgYSBzaW5nbGUgUHJpc21hQ2xpZW50IGluc3RhbmNlIGluIGRldmVsb3BtZW50IHRvIGF2b2lkIGV4aGF1c3Rpbmdcbi8vIGRhdGFiYXNlIGNvbm5lY3Rpb25zIGR1cmluZyBITVIgKHNlZSBQcmlzbWEgZG9jcykuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby12YXJcbiAgdmFyIF9fcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59XG5cbmV4cG9ydCBjb25zdCBwcmlzbWEgPSAoZ2xvYmFsLl9fcHJpc21hID8/PSBuZXcgUHJpc21hQ2xpZW50KCkpO1xuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbC5fX3ByaXNtYSA9IHByaXNtYTtcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJwcmlzbWEiLCJnbG9iYWwiLCJfX3ByaXNtYSIsInByb2Nlc3MiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/lib/prisma.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/actions/transactions.ts":
/*!********************************************!*\
  !*** ./src/server/actions/transactions.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createExpense: () => (/* binding */ createExpense),\n/* harmony export */   createExpenseForm: () => (/* binding */ createExpenseForm),\n/* harmony export */   createIncome: () => (/* binding */ createIncome),\n/* harmony export */   createTransfer: () => (/* binding */ createTransfer)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/prisma */ \"(action-browser)/./src/lib/prisma.ts\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth */ \"(action-browser)/./src/lib/auth.ts\");\n/* harmony import */ var _server_validators_transactions__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/server/validators/transactions */ \"(action-browser)/./src/server/validators/transactions.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.23.8/node_modules/zod/lib/index.mjs\");\n/* harmony import */ var _server_queries_envelopes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/server/queries/envelopes */ \"(action-browser)/./src/server/queries/envelopes.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(action-browser)/./node_modules/.pnpm/next@15.0.3_@playwright+tes_c0fbebec67a33fb30e42c14d3a81a9d2/node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"4072c2ed01f650f13b1e26f5192428aca79f15dade\":\"createExpenseForm\",\"4074222edd5ce33cb6195a2680994a71d6a8ebca01\":\"createIncome\",\"40a9da69e30072e002e828b95592a27675a27bd63f\":\"createExpense\",\"40b351b61e3fe4f8f694a0367795adfe24b7170a08\":\"createTransfer\"} */ \n\n\n\n\n\n\nasync function createIncome(input) {\n    await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_3__.requireRole)([\n        \"operator\",\n        \"manager\"\n    ]);\n    const parsed = _server_validators_transactions__WEBPACK_IMPORTED_MODULE_4__.CreateIncomeSchema.safeParse(input);\n    if (!parsed.success) throw new Error(parsed.error.errors.map((e)=>e.message).join(\"; \"));\n    const tx = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transaction.create({\n        data: {\n            kind: \"IN\",\n            label: \"Entr√©e\",\n            amount: parsed.data.amount,\n            at: new Date(),\n            serviceId: parsed.data.serviceId\n        }\n    });\n    return {\n        transactionId: tx.id\n    };\n}\nasync function createExpense(input) {\n    await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_3__.requireRole)([\n        \"operator\",\n        \"manager\"\n    ]);\n    const parsed = _server_validators_transactions__WEBPACK_IMPORTED_MODULE_4__.CreateExpenseSchema.safeParse(input);\n    if (!parsed.success) throw new Error(parsed.error.errors.map((e)=>e.message).join(\"; \"));\n    // Charger enveloppes pour validations simples (existence / active / protected)\n    const envIds = parsed.data.allocations.map((a)=>a.envelopeId);\n    const envWithTypes = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.envelope.findMany({\n        where: {\n            id: {\n                in: envIds\n            }\n        },\n        select: {\n            id: true,\n            name: true,\n            protected: true,\n            active: true\n        }\n    });\n    const map = new Map(envWithTypes.map((e)=>[\n            e.id,\n            e\n        ]));\n    const balances = await (0,_server_queries_envelopes__WEBPACK_IMPORTED_MODULE_5__.getAllEnvelopeBalances)();\n    const envs = envWithTypes.map((e)=>({\n            id: e.id,\n            name: e.name,\n            protected: e.protected,\n            active: e.active\n        }));\n    const envMap = new Map(envs.map((e)=>[\n            e.id,\n            e\n        ]));\n    const balMap = new Map(balances.map((b)=>[\n            b.envelopeId,\n            b.balance\n        ]));\n    const anomalies = [];\n    for (const a of parsed.data.allocations){\n        const env = envMap.get(a.envelopeId);\n        if (!env) throw new Error(\"Enveloppe inconnue\");\n        if (!env.active) throw new Error(`Enveloppe ${env.name} inactive`);\n        const available = balMap.get(a.envelopeId) ?? 0;\n        if (env.protected && !parsed.data.allowOverride) throw new Error(`Enveloppe prot√©g√©e (${env.name}) ‚Äî d√©rogation requise`);\n        if (env.protected && parsed.data.allowOverride) anomalies.push({\n            level: \"critical\",\n            code: \"PROTECTED_ENVELOPE_USED\",\n            details: `D√©pense sur enveloppe prot√©g√©e (${env.name})`\n        });\n        if (a.amount > available) {\n            if (!parsed.data.allowOverride) throw new Error(`Allocation > solde (${env.name})`);\n            anomalies.push({\n                level: \"warning\",\n                code: \"NEGATIVE_BALANCE\",\n                details: `Allocation ${a.amount} > solde ${available} sur ${env.name}`\n            });\n        }\n    }\n    const tx = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transaction.create({\n        data: {\n            kind: \"OUT\",\n            label: \"D√©pense\",\n            amount: parsed.data.total,\n            at: new Date()\n        }\n    });\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transactionAllocation.createMany({\n        data: parsed.data.allocations.map((a)=>({\n                transactionId: tx.id,\n                envelopeId: a.envelopeId,\n                amount: a.amount\n            }))\n    });\n    if (anomalies.length) {\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.anomaly.createMany({\n            data: anomalies.map((an)=>({\n                    level: an.level,\n                    code: an.code,\n                    details: parsed.data.overrideReason ? `${an.details} ‚Äî Raison: ${parsed.data.overrideReason}` : an.details,\n                    transactionId: tx.id\n                }))\n        });\n    }\n    return {\n        transactionId: tx.id,\n        anomalies\n    };\n}\nasync function createTransfer(input) {\n    await (0,_lib_auth__WEBPACK_IMPORTED_MODULE_3__.requireRole)([\n        \"operator\",\n        \"manager\"\n    ]);\n    const Schema = zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n        fromEnvelopeId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string().min(1),\n        toEnvelopeId: zod__WEBPACK_IMPORTED_MODULE_6__.z.string().min(1),\n        amount: zod__WEBPACK_IMPORTED_MODULE_6__.z.number().int().positive(),\n        allowOverride: zod__WEBPACK_IMPORTED_MODULE_6__.z.boolean().optional(),\n        reason: zod__WEBPACK_IMPORTED_MODULE_6__.z.string().max(500).optional()\n    });\n    const p = Schema.safeParse(input);\n    if (!p.success) throw new Error(p.error.errors.map((e)=>e.message).join('; '));\n    const { fromEnvelopeId, toEnvelopeId, amount, allowOverride, reason } = p.data;\n    if (fromEnvelopeId === toEnvelopeId) throw new Error(\"Les enveloppes source et destination doivent √™tre diff√©rentes\");\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.envelope.findMany({\n        where: {\n            id: {\n                in: [\n                    fromEnvelopeId,\n                    toEnvelopeId\n                ]\n            }\n        },\n        select: {\n            id: true,\n            name: true,\n            protected: true,\n            active: true\n        }\n    });\n    const envMap = new Map(envs.map((e)=>[\n            e.id,\n            e\n        ]));\n    const fromEnv = envMap.get(fromEnvelopeId);\n    const toEnv = envMap.get(toEnvelopeId);\n    if (!fromEnv) throw new Error(\"Enveloppe source introuvable\");\n    if (!toEnv) throw new Error(\"Enveloppe destination introuvable\");\n    if (!fromEnv.active) throw new Error(`Enveloppe source (${fromEnv.name}) inactive`);\n    if (!toEnv.active) throw new Error(`Enveloppe destination (${toEnv.name}) inactive`);\n    const balances = await (0,_server_queries_envelopes__WEBPACK_IMPORTED_MODULE_5__.getAllEnvelopeBalances)();\n    const balMap = new Map(balances.map((b)=>[\n            b.envelopeId,\n            b.balance\n        ]));\n    const available = balMap.get(fromEnvelopeId) ?? 0;\n    const anomalies = [];\n    if (fromEnv.protected && !allowOverride) throw new Error(`Enveloppe prot√©g√©e (${fromEnv.name}) ‚Äî d√©rogation requise`);\n    if (amount > available) {\n        if (!allowOverride) throw new Error(`Montant > solde disponible (${fromEnv.name})`);\n        anomalies.push({\n            level: 'warning',\n            code: 'NEGATIVE_BALANCE_TRANSFER',\n            details: `Transfert ${amount} > solde ${available} depuis ${fromEnv.name}`\n        });\n    }\n    // Create OUT transaction (debit from source)\n    const outTx = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transaction.create({\n        data: {\n            kind: 'OUT',\n            label: `Transfert vers ${toEnv.name}`,\n            amount,\n            at: new Date()\n        }\n    });\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transactionAllocation.create({\n        data: {\n            transactionId: outTx.id,\n            envelopeId: fromEnvelopeId,\n            amount\n        }\n    });\n    // Create IN transaction (credit to destination)\n    const inTx = await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transaction.create({\n        data: {\n            kind: 'IN',\n            label: `Transfert depuis ${fromEnv.name}`,\n            amount,\n            at: new Date()\n        }\n    });\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.transactionAllocation.create({\n        data: {\n            transactionId: inTx.id,\n            envelopeId: toEnvelopeId,\n            amount\n        }\n    });\n    if (anomalies.length) {\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_2__.prisma.anomaly.createMany({\n            data: anomalies.map((a)=>({\n                    level: a.level,\n                    code: a.code,\n                    details: a.details + (reason ? ` ‚Äî Raison: ${reason}` : ''),\n                    transactionId: outTx.id\n                }))\n        });\n    }\n    return {\n        outTransactionId: outTx.id,\n        inTransactionId: inTx.id,\n        anomalies\n    };\n}\n// Adapter to accept a FormData from a form[action] submission.\nasync function createExpenseForm(formData) {\n    // Parse structured form fields:\n    // total, allowOverride, overrideReason, allocations[i].envelopeId, allocations[i].amount\n    const totalRaw = formData.get('total');\n    const total = totalRaw ? Number(totalRaw) : 0;\n    const allowOverride = formData.get('allowOverride') === 'on' || formData.get('allowOverride') === 'true';\n    const overrideReason = String(formData.get('overrideReason') ?? \"\");\n    // Collect allocations by scanning keys like allocations[0].envelopeId and allocations[0].amount\n    const allocations = [];\n    for (const key of Array.from(formData.keys())){\n        const m = key.match(/^allocations\\[(\\d+)\\]\\.(envelopeId|amount)$/);\n        if (m) {\n            const idx = Number(m[1]);\n            const field = m[2];\n            allocations[idx] = allocations[idx] ?? {\n                envelopeId: \"\",\n                amount: 0\n            };\n            const val = formData.get(key);\n            if (field === 'envelopeId') allocations[idx].envelopeId = String(val ?? \"\");\n            if (field === 'amount') allocations[idx].amount = Number(val ?? 0);\n        }\n    }\n    // Filter out empty allocation slots\n    const allocsFiltered = allocations.filter((a)=>a && a.envelopeId && Number(a.amount) > 0);\n    const input = {\n        total,\n        allocations: allocsFiltered,\n        allowOverride,\n        overrideReason\n    };\n    return createExpense(input);\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_7__.ensureServerEntryExports)([\n    createIncome,\n    createExpense,\n    createTransfer,\n    createExpenseForm\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(createIncome, \"4074222edd5ce33cb6195a2680994a71d6a8ebca01\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(createExpense, \"40a9da69e30072e002e828b95592a27675a27bd63f\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(createTransfer, \"40b351b61e3fe4f8f694a0367795adfe24b7170a08\", null);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(createExpenseForm, \"4072c2ed01f650f13b1e26f5192428aca79f15dade\", null);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvYWN0aW9ucy90cmFuc2FjdGlvbnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQ3NDO0FBQ0c7QUFDa0Q7QUFDbkU7QUFDNEM7QUFJN0QsZUFBZU0sYUFBYUMsS0FBbUQ7SUFDcEYsTUFBTU4sc0RBQVdBLENBQUM7UUFBQztRQUFXO0tBQVU7SUFDeEMsTUFBTU8sU0FBT04sK0VBQWtCQSxDQUFDTyxTQUFTLENBQUNGO0lBQVEsSUFBRyxDQUFDQyxPQUFPRSxPQUFPLEVBQUUsTUFBTSxJQUFJQyxNQUFNSCxPQUFPSSxLQUFLLENBQUNDLE1BQU0sQ0FBQ0MsR0FBRyxDQUFDQyxDQUFBQSxJQUFHQSxFQUFFQyxPQUFPLEVBQUVDLElBQUksQ0FBQztJQUNqSSxNQUFNQyxLQUFHLE1BQU1sQiwrQ0FBTUEsQ0FBQ21CLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO1FBQUVDLE1BQUs7WUFBRUMsTUFBSztZQUFNQyxPQUFNO1lBQVVDLFFBQU9oQixPQUFPYSxJQUFJLENBQUNHLE1BQU07WUFBRUMsSUFBRyxJQUFJQztZQUFRQyxXQUFVbkIsT0FBT2EsSUFBSSxDQUFDTSxTQUFTO1FBQUM7SUFBRTtJQUN6SixPQUFPO1FBQUVDLGVBQWVWLEdBQUdXLEVBQUU7SUFBQztBQUNoQztBQUVPLGVBQWVDLGNBQWN2QixLQUEwSDtJQUM1SixNQUFNTixzREFBV0EsQ0FBQztRQUFDO1FBQVc7S0FBVTtJQUN4QyxNQUFNTyxTQUFPTCxnRkFBbUJBLENBQUNNLFNBQVMsQ0FBQ0Y7SUFBUSxJQUFHLENBQUNDLE9BQU9FLE9BQU8sRUFBRSxNQUFNLElBQUlDLE1BQU1ILE9BQU9JLEtBQUssQ0FBQ0MsTUFBTSxDQUFDQyxHQUFHLENBQUNDLENBQUFBLElBQUdBLEVBQUVDLE9BQU8sRUFBRUMsSUFBSSxDQUFDO0lBQ2xJLCtFQUErRTtJQUMvRSxNQUFNYyxTQUFTdkIsT0FBT2EsSUFBSSxDQUFDVyxXQUFXLENBQUNsQixHQUFH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QU02RCxPQUFPQyxNQUFNQyxJQUFJLENBQUNOLFNBQVNPLElBQUksSUFBSTtRQUMzQyxNQUFNQyxJQUFJSixJQUFJSyxLQUFLLENBQUM7UUFDcEIsSUFBR0QsR0FBRTtZQUNILE1BQU1FLE1BQU1SLE9BQU9NLENBQUMsQ0FBQyxFQUFFO1lBQ3ZCLE1BQU1HLFFBQVFILENBQUMsQ0FBQyxFQUFFO1lBQ2xCakUsV0FBVyxDQUFDbUUsSUFBSSxHQUFHbkUsV0FBVyxDQUFDbUUsSUFBSSxJQUFJO2dCQUFFakUsWUFBWTtnQkFBSVYsUUFBUTtZQUFFO1lBQ25FLE1BQU02RSxNQUFNWixTQUFTcEMsR0FBRyxDQUFDd0M7WUFDekIsSUFBR08sVUFBVSxjQUFjcEUsV0FBVyxDQUFDbUUsSUFBSSxDQUFDakUsVUFBVSxHQUFHMEQsT0FBT1MsT0FBTztZQUN2RSxJQUFHRCxVQUFVLFVBQVVwRSxXQUFXLENBQUNtRSxJQUFJLENBQUMzRSxNQUFNLEdBQUdtRSxPQUFPVSxPQUFPO1FBQ2pFO0lBQ0Y7SUFFQSxvQ0FBb0M7SUFDcEMsTUFBTUMsaUJBQWlCdEUsWUFBWXVFLE1BQU0sQ0FBQ3RFLENBQUFBLElBQUtBLEtBQUtBLEVBQUVDLFVBQVUsSUFBSXlELE9BQU8xRCxFQUFFVCxNQUFNLElBQUk7SUFFdkYsTUFBTWpCLFFBQVE7UUFBRXFEO1FBQU81QixhQUFhc0U7UUFBZ0IvQztRQUFlVztJQUFlO0lBQ2xGLE9BQU9wQyxjQUFjdkI7QUFDdkI7OztJQTlHc0JEO0lBT0F3QjtJQWdDQXFDO0lBNENBcUI7O0FBbkZBbEYsMEZBQUFBLENBQUFBO0FBT0F3QiwwRkFBQUEsQ0FBQUE7QUFnQ0FxQywwRkFBQUEsQ0FBQUE7QUE0Q0FxQiwwRkFBQUEsQ0FBQUEiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxcYWN0aW9uc1xcdHJhbnNhY3Rpb25zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHNlcnZlclwiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgcmVxdWlyZVJvbGUgfSBmcm9tIFwiQC9saWIvYXV0aFwiO1xuaW1wb3J0IHsgQ3JlYXRlSW5jb21lU2NoZW1hLCBDcmVhdGVFeHBlbnNlU2NoZW1hIH0gZnJvbSBcIkAvc2VydmVyL3ZhbGlkYXRvcnMvdHJhbnNhY3Rpb25zXCI7XG5pbXBvcnQgeyB6IH0gZnJvbSBcInpvZFwiO1xuaW1wb3J0IHsgZ2V0QWxsRW52ZWxvcGVCYWxhbmNlcyB9IGZyb20gXCJAL3NlcnZlci9xdWVyaWVzL2VudmVsb3Blc1wiO1xuLy8gVHlwZSBwb2xpY2llcyByZW1vdmVkIHdpdGggQ2hhcmdlVHlwZSByZWZhY3RvcjsgcG9saWN5IGNoZWNrcyByZW1vdmVkL3NpbXBsaWZpZWRcbmltcG9ydCB0eXBlIHsgQW5vbWFseUxpc3RJdGVtIH0gZnJvbSBcIkAvc2VydmVyL3R5cGVzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVJbmNvbWUoaW5wdXQ6e3NlcnZpY2VJZDpzdHJpbmc7YW1vdW50Om51bWJlcjtub3RlPzpzdHJpbmd9KXtcbiAgYXdhaXQgcmVxdWlyZVJvbGUoW1wib3BlcmF0b3JcIixcIm1hbmFnZXJcIl0pO1xuICBjb25zdCBwYXJzZWQ9Q3JlYXRlSW5jb21lU2NoZW1hLnNhZmVQYXJzZShpbnB1dCk7IGlmKCFwYXJzZWQuc3VjY2VzcykgdGhyb3cgbmV3IEVycm9yKHBhcnNlZC5lcnJvci5lcnJvcnMubWFwKGU9PmUubWVzc2FnZSkuam9pbihcIjsgXCIpKTtcbiAgY29uc3QgdHg9YXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uLmNyZWF0ZSh7IGRhdGE6eyBraW5kOlwiSU5cIiwgbGFiZWw6XCJFbnRyw6llXCIsIGFtb3VudDpwYXJzZWQuZGF0YS5hbW91bnQsIGF0Om5ldyBEYXRlKCksIHNlcnZpY2VJZDpwYXJzZWQuZGF0YS5zZXJ2aWNlSWQgfSB9KTtcbiAgcmV0dXJuIHsgdHJhbnNhY3Rpb25JZDogdHguaWQgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUV4cGVuc2UoaW5wdXQ6eyB0b3RhbDpudW1iZXI7IGFsbG9jYXRpb25zOnsgZW52ZWxvcGVJZDpzdHJpbmc7IGFtb3VudDpudW1iZXIgfVtdOyBhbGxvd092ZXJyaWRlPzpib29sZWFuOyBvdmVycmlkZVJlYXNvbj86c3RyaW5nIH0pe1xuICBhd2FpdCByZXF1aXJlUm9sZShbXCJvcGVyYXRvclwiLFwibWFuYWdlclwiXSk7XG4gIGNvbnN0IHBhcnNlZD1DcmVhdGVFeHBlbnNlU2NoZW1hLnNhZmVQYXJzZShpbnB1dCk7IGlmKCFwYXJzZWQuc3VjY2VzcykgdGhyb3cgbmV3IEVycm9yKHBhcnNlZC5lcnJvci5lcnJvcnMubWFwKGU9PmUubWVzc2FnZSkuam9pbihcIjsgXCIpKTtcbiAgLy8gQ2hhcmdlciBlbnZlbG9wcGVzIHBvdXIgdmFsaWRhdGlvbnMgc2ltcGxlcyAoZXhpc3RlbmNlIC8gYWN0aXZlIC8gcHJvdGVjdGVkKVxuICBjb25zdCBlbnZJZHMgPSBwYXJzZWQuZGF0YS5hbGxvY2F0aW9ucy5tYXAoKGE6YW55KT0+IGEuZW52ZWxvcGVJZCk7XG4gIGNvbnN0IGVudldpdGhUeXBlcyA9IGF3YWl0IHByaXNtYS5lbnZlbG9wZS5maW5kTWFueSh7IHdoZXJlOiB7IGlkOiB7IGluOiBlbnZJZHMgfSB9LCBzZWxlY3Q6IHsgaWQ6dHJ1ZSwgbmFtZTp0cnVlLCBwcm90ZWN0ZWQ6dHJ1ZSwgYWN0aXZlOnRydWUgfSB9KTtcbiAgY29uc3QgbWFwID0gbmV3IE1hcChlbnZXaXRoVHlwZXMubWFwKChlOmFueSk9PltlLmlkLCBlXSkpO1xuICBjb25zdCBiYWxhbmNlcyA9IGF3YWl0IGdldEFsbEVudmVsb3BlQmFsYW5jZXMoKTtcbiAgY29uc3QgZW52cyA9IGVudldpdGhUeXBlcy5tYXAoKGU6YW55KT0+KHsgaWQ6ZS5pZCwgbmFtZTplLm5hbWUsIHByb3RlY3RlZDplLnByb3RlY3RlZCwgYWN0aXZlOmUuYWN0aXZlIH0pKTtcbiAgdHlwZSBFbnYgPSB7IGlkOnN0cmluZzsgbmFtZTpzdHJpbmc7IHByb3RlY3RlZDpib29sZWFuOyBhY3RpdmU6Ym9vbGVhbiB9O1xuICB0eXBlIEJhbCA9IHsgZW52ZWxvcGVJZDpzdHJpbmc7IGJhbGFuY2U6bnVtYmVyIH07XG4gIGNvbnN0IGVudk1hcD1uZXcgTWFwKChlbnZzIGFzIEVudltdKS5tYXAoKGU6RW52KT0+W2UuaWQsZV0pKTtcbiAgY29uc3QgYmFsTWFwPW5ldyBNYXAoKGJhbGFuY2VzIGFzIEJhbFtdKS5tYXAoKGI6QmFsKT0+W2IuZW52ZWxvcGVJZCxiLmJhbGFuY2VdKSk7XG4gIGNvbnN0IGFub21hbGllczoge2xldmVsOlwiY3JpdGljYWxcInxcIndhcm5pbmdcIjsgY29kZTpzdHJpbmc7IGRldGFpbHM6c3RyaW5nfVtdID0gW107XG4gIGZvcihjb25zdCBhIG9mIHBhcnNlZC5kYXRhLmFsbG9jYXRpb25zKXtcbiAgICBjb25zdCBlbnYgPSBlbnZNYXAuZ2V0KGEuZW52ZWxvcGVJZCkgYXMgRW52IHwgdW5kZWZpbmVkO1xuICAgIGlmKCFlbnYpIHRocm93IG5ldyBFcnJvcihcIkVudmVsb3BwZSBpbmNvbm51ZVwiKTtcbiAgICBpZighZW52LmFjdGl2ZSkgdGhyb3cgbmV3IEVycm9yKGBFbnZlbG9wcGUgJHtlbnYubmFtZX0gaW5hY3RpdmVgKTtcbiAgICBjb25zdCBhdmFpbGFibGUgPSBiYWxNYXAuZ2V0KGEuZW52ZWxvcGVJZCkgPz8gMDtcbiAgICBpZihlbnYucHJvdGVjdGVkICYmICFwYXJzZWQuZGF0YS5hbGxvd092ZXJyaWRlKSB0aHJvdyBuZXcgRXJyb3IoYEVudmVsb3BwZSBwcm90w6lnw6llICgke2Vudi5uYW1lfSkg4oCUIGTDqXJvZ2F0aW9uIHJlcXVpc2VgKTtcbiAgICBpZihlbnYucHJvdGVjdGVkICYmIHBhcnNlZC5kYXRhLmFsbG93T3ZlcnJpZGUpIGFub21hbGllcy5wdXNoKHsgbGV2ZWw6XCJjcml0aWNhbFwiLCBjb2RlOlwiUFJPVEVDVEVEX0VOVkVMT1BFX1VTRURcIiwgZGV0YWlsczpgRMOpcGVuc2Ugc3VyIGVudmVsb3BwZSBwcm90w6lnw6llICgke2Vudi5uYW1lfSlgIH0pO1xuICAgIGlmKGEuYW1vdW50ID4gYXZhaWxhYmxlKXtcbiAgICAgIGlmKCFwYXJzZWQuZGF0YS5hbGxvd092ZXJyaWRlKSB0aHJvdyBuZXcgRXJyb3IoYEFsbG9jYXRpb24gPiBzb2xkZSAoJHtlbnYubmFtZX0pYCk7XG4gICAgICBhbm9tYWxpZXMucHVzaCh7IGxldmVsOlwid2FybmluZ1wiLCBjb2RlOlwiTkVHQVRJVkVfQkFMQU5DRVwiLCBkZXRhaWxzOmBBbGxvY2F0aW9uICR7YS5hbW91bnR9ID4gc29sZGUgJHthdmFpbGFibGV9IHN1ciAke2Vudi5uYW1lfWAgfSk7XG4gICAgfVxuICB9XG4gIGNvbnN0IHR4PWF3YWl0IHByaXNtYS50cmFuc2FjdGlvbi5jcmVhdGUoeyBkYXRhOnsga2luZDpcIk9VVFwiLCBsYWJlbDpcIkTDqXBlbnNlXCIsIGFtb3VudDpwYXJzZWQuZGF0YS50b3RhbCwgYXQ6bmV3IERhdGUoKSB9IH0pO1xuICBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmNyZWF0ZU1hbnkoeyBkYXRhOiBwYXJzZWQuZGF0YS5hbGxvY2F0aW9ucy5tYXAoYT0+KHsgdHJhbnNhY3Rpb25JZDp0eC5pZCwgZW52ZWxvcGVJZDphLmVudmVsb3BlSWQsIGFtb3VudDphLmFtb3VudCB9KSkgfSk7XG4gIGlmKGFub21hbGllcy5sZW5ndGgpeyBhd2FpdCBwcmlzbWEuYW5vbWFseS5jcmVhdGVNYW55KHsgZGF0YTogYW5vbWFsaWVzLm1hcChhbj0+KHsgbGV2ZWw6YW4ubGV2ZWwsIGNvZGU6YW4uY29kZSwgZGV0YWlsczogcGFyc2VkLmRhdGEub3ZlcnJpZGVSZWFzb24/YCR7YW4uZGV0YWlsc30g4oCUIFJhaXNvbjogJHtwYXJzZWQuZGF0YS5vdmVycmlkZVJlYXNvbn1gOmFuLmRldGFpbHMsIHRyYW5zYWN0aW9uSWQ6dHguaWQgfSkpIH0pOyB9XG4gIHJldHVybiB7IHRyYW5zYWN0aW9uSWQ6IHR4LmlkLCBhbm9tYWxpZXMgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVRyYW5zZmVyKGlucHV0OnsgZnJvbUVudmVsb3BlSWQ6c3RyaW5nOyB0b0VudmVsb3BlSWQ6c3RyaW5nOyBhbW91bnQ6bnVtYmVyOyBhbGxvd092ZXJyaWRlPzpib29sZWFuOyByZWFzb24/OnN0cmluZyB9KXtcbiAgYXdhaXQgcmVxdWlyZVJvbGUoW1wib3BlcmF0b3JcIixcIm1hbmFnZXJcIl0pO1xuICBjb25zdCBTY2hlbWEgPSB6Lm9iamVjdCh7IGZyb21FbnZlbG9wZUlkOiB6LnN0cmluZygpLm1pbigxKSwgdG9FbnZlbG9wZUlkOiB6LnN0cmluZygpLm1pbigxKSwgYW1vdW50OiB6Lm51bWJlcigpLmludCgpLnBvc2l0aXZlKCksIGFsbG93T3ZlcnJpZGU6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksIHJlYXNvbjogei5zdHJpbmcoKS5tYXgoNTAwKS5vcHRpb25hbCgpIH0pO1xuICBjb25zdCBwID0gU2NoZW1hLnNhZmVQYXJzZShpbnB1dCk7IGlmKCFwLnN1Y2Nlc3MpIHRocm93IG5ldyBFcnJvcihwLmVycm9yLmVycm9ycy5tYXAoZT0+ZS5tZXNzYWdlKS5qb2luKCc7ICcpKTtcblxuICBjb25zdCB7IGZyb21FbnZlbG9wZUlkLCB0b0VudmVsb3BlSWQsIGFtb3VudCwgYWxsb3dPdmVycmlkZSwgcmVhc29uIH0gPSBwLmRhdGE7XG4gIGlmKGZyb21FbnZlbG9wZUlkID09PSB0b0VudmVsb3BlSWQpIHRocm93IG5ldyBFcnJvcihcIkxlcyBlbnZlbG9wcGVzIHNvdXJjZSBldCBkZXN0aW5hdGlvbiBkb2l2ZW50IMOqdHJlIGRpZmbDqXJlbnRlc1wiKTtcblxuICBjb25zdCBlbnZzID0gYXdhaXQgcHJpc21hLmVudmVsb3BlLmZpbmRNYW55KHsgd2hlcmU6IHsgaWQ6IHsgaW46IFtmcm9tRW52ZWxvcGVJZCwgdG9FbnZlbG9wZUlkXSB9IH0sIHNlbGVjdDogeyBpZDp0cnVlLCBuYW1lOnRydWUsIHByb3RlY3RlZDp0cnVlLCBhY3RpdmU6dHJ1ZSB9IH0pO1xuICBjb25zdCBlbnZNYXAgPSBuZXcgTWFwKGVudnMubWFwKGU9PltlLmlkLGVdKSk7XG4gIGNvbnN0IGZyb21FbnYgPSBlbnZNYXAuZ2V0KGZyb21FbnZlbG9wZUlkKTsgY29uc3QgdG9FbnYgPSBlbnZNYXAuZ2V0KHRvRW52ZWxvcGVJZCk7XG4gIGlmKCFmcm9tRW52KSB0aHJvdyBuZXcgRXJyb3IoXCJFbnZlbG9wcGUgc291cmNlIGludHJvdXZhYmxlXCIpO1xuICBpZighdG9FbnYpIHRocm93IG5ldyBFcnJvcihcIkVudmVsb3BwZSBkZXN0aW5hdGlvbiBpbnRyb3V2YWJsZVwiKTtcbiAgaWYoIWZyb21FbnYuYWN0aXZlKSB0aHJvdyBuZXcgRXJyb3IoYEVudmVsb3BwZSBzb3VyY2UgKCR7ZnJvbUVudi5uYW1lfSkgaW5hY3RpdmVgKTtcbiAgaWYoIXRvRW52LmFjdGl2ZSkgdGhyb3cgbmV3IEVycm9yKGBFbnZlbG9wcGUgZGVzdGluYXRpb24gKCR7dG9FbnYubmFtZX0pIGluYWN0aXZlYCk7XG5cbiAgY29uc3QgYmFsYW5jZXMgPSBhd2FpdCBnZXRBbGxFbnZlbG9wZUJhbGFuY2VzKCk7XG4gIGNvbnN0IGJhbE1hcCA9IG5ldyBNYXAoKGJhbGFuY2VzIGFzIGFueVtdKS5tYXAoKGI6YW55KT0+W2IuZW52ZWxvcGVJZCwgYi5iYWxhbmNlXSkpO1xuICBjb25zdCBhdmFpbGFibGUgPSBiYWxNYXAuZ2V0KGZyb21FbnZlbG9wZUlkKSA/PyAwO1xuXG4gIGNvbnN0IGFub21hbGllczogeyBsZXZlbDogJ2NyaXRpY2FsJ3wnd2FybmluZyc7IGNvZGU6c3RyaW5nOyBkZXRhaWxzOnN0cmluZyB9W10gPSBbXTtcblxuICBpZihmcm9tRW52LnByb3RlY3RlZCAmJiAhYWxsb3dPdmVycmlkZSkgdGhyb3cgbmV3IEVycm9yKGBFbnZlbG9wcGUgcHJvdMOpZ8OpZSAoJHtmcm9tRW52Lm5hbWV9KSDigJQgZMOpcm9nYXRpb24gcmVxdWlzZWApO1xuICBpZihhbW91bnQgPiBhdmFpbGFibGUpe1xuICAgIGlmKCFhbGxvd092ZXJyaWRlKSB0aHJvdyBuZXcgRXJyb3IoYE1vbnRhbnQgPiBzb2xkZSBkaXNwb25pYmxlICgke2Zyb21FbnYubmFtZX0pYCk7XG4gICAgYW5vbWFsaWVzLnB1c2goeyBsZXZlbDogJ3dhcm5pbmcnLCBjb2RlOiAnTkVHQVRJVkVfQkFMQU5DRV9UUkFOU0ZFUicsIGRldGFpbHM6IGBUcmFuc2ZlcnQgJHthbW91bnR9ID4gc29sZGUgJHthdmFpbGFibGV9IGRlcHVpcyAke2Zyb21FbnYubmFtZX1gIH0pO1xuICB9XG5cbiAgLy8gQ3JlYXRlIE9VVCB0cmFuc2FjdGlvbiAoZGViaXQgZnJvbSBzb3VyY2UpXG4gIGNvbnN0IG91dFR4ID0gYXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uLmNyZWF0ZSh7IGRhdGE6IHsga2luZDogJ09VVCcsIGxhYmVsOiBgVHJhbnNmZXJ0IHZlcnMgJHt0b0Vudi5uYW1lfWAsIGFtb3VudCwgYXQ6IG5ldyBEYXRlKCkgfSB9KTtcbiAgYXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5jcmVhdGUoeyBkYXRhOiB7IHRyYW5zYWN0aW9uSWQ6IG91dFR4LmlkLCBlbnZlbG9wZUlkOiBmcm9tRW52ZWxvcGVJZCwgYW1vdW50IH0gfSk7XG5cbiAgLy8gQ3JlYXRlIElOIHRyYW5zYWN0aW9uIChjcmVkaXQgdG8gZGVzdGluYXRpb24pXG4gIGNvbnN0IGluVHggPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb24uY3JlYXRlKHsgZGF0YTogeyBraW5kOiAnSU4nLCBsYWJlbDogYFRyYW5zZmVydCBkZXB1aXMgJHtmcm9tRW52Lm5hbWV9YCwgYW1vdW50LCBhdDogbmV3IERhdGUoKSB9IH0pO1xuICBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmNyZWF0ZSh7IGRhdGE6IHsgdHJhbnNhY3Rpb25JZDogaW5UeC5pZCwgZW52ZWxvcGVJZDogdG9FbnZlbG9wZUlkLCBhbW91bnQgfSB9KTtcblxuICBpZihhbm9tYWxpZXMubGVuZ3RoKXtcbiAgICBhd2FpdCBwcmlzbWEuYW5vbWFseS5jcmVhdGVNYW55KHsgZGF0YTogYW5vbWFsaWVzLm1hcChhPT4oeyBsZXZlbDogYS5sZXZlbCwgY29kZTogYS5jb2RlLCBkZXRhaWxzOiAoYS5kZXRhaWxzICsgKHJlYXNvbiA/IGAg4oCUIFJhaXNvbjogJHtyZWFzb259YCA6ICcnKSksIHRyYW5zYWN0aW9uSWQ6IG91dFR4LmlkIH0pKSB9KTtcbiAgfVxuXG4gIHJldHVybiB7IG91dFRyYW5zYWN0aW9uSWQ6IG91dFR4LmlkLCBpblRyYW5zYWN0aW9uSWQ6IGluVHguaWQsIGFub21hbGllcyB9O1xufVxuXG4vLyBBZGFwdGVyIHRvIGFjY2VwdCBhIEZvcm1EYXRhIGZyb20gYSBmb3JtW2FjdGlvbl0gc3VibWlzc2lvbi5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVFeHBlbnNlRm9ybShmb3JtRGF0YTogRm9ybURhdGEpe1xuICAvLyBQYXJzZSBzdHJ1Y3R1cmVkIGZvcm0gZmllbGRzOlxuICAvLyB0b3RhbCwgYWxsb3dPdmVycmlkZSwgb3ZlcnJpZGVSZWFzb24sIGFsbG9jYXRpb25zW2ldLmVudmVsb3BlSWQsIGFsbG9jYXRpb25zW2ldLmFtb3VudFxuICBjb25zdCB0b3RhbFJhdyA9IGZvcm1EYXRhLmdldCgndG90YWwnKTtcbiAgY29uc3QgdG90YWwgPSB0b3RhbFJhdyA/IE51bWJlcih0b3RhbFJhdykgOiAwO1xuICBjb25zdCBhbGxvd092ZXJyaWRlID0gZm9ybURhdGEuZ2V0KCdhbGxvd092ZXJyaWRlJykgPT09ICdvbicgfHwgZm9ybURhdGEuZ2V0KCdhbGxvd092ZXJyaWRlJykgPT09ICd0cnVlJztcbiAgY29uc3Qgb3ZlcnJpZGVSZWFzb24gPSBTdHJpbmcoZm9ybURhdGEuZ2V0KCdvdmVycmlkZVJlYXNvbicpID8/IFwiXCIpO1xuXG4gIC8vIENvbGxlY3QgYWxsb2NhdGlvbnMgYnkgc2Nhbm5pbmcga2V5cyBsaWtlIGFsbG9jYXRpb25zWzBdLmVudmVsb3BlSWQgYW5kIGFsbG9jYXRpb25zWzBdLmFtb3VudFxuICBjb25zdCBhbGxvY2F0aW9uczogeyBlbnZlbG9wZUlkOnN0cmluZzsgYW1vdW50Om51bWJlciB9W10gPSBbXTtcbiAgZm9yKGNvbnN0IGtleSBvZiBBcnJheS5mcm9tKGZvcm1EYXRhLmtleXMoKSkpe1xuICAgIGNvbnN0IG0gPSBrZXkubWF0Y2goL15hbGxvY2F0aW9uc1xcWyhcXGQrKVxcXVxcLihlbnZlbG9wZUlkfGFtb3VudCkkLyk7XG4gICAgaWYobSl7XG4gICAgICBjb25zdCBpZHggPSBOdW1iZXIobVsxXSk7XG4gICAgICBjb25zdCBmaWVsZCA9IG1bMl07XG4gICAgICBhbGxvY2F0aW9uc1tpZHhdID0gYWxsb2NhdGlvbnNbaWR4XSA/PyB7IGVudmVsb3BlSWQ6IFwiXCIsIGFtb3VudDogMCB9O1xuICAgICAgY29uc3QgdmFsID0gZm9ybURhdGEuZ2V0KGtleSk7XG4gICAgICBpZihmaWVsZCA9PT0gJ2VudmVsb3BlSWQnKSBhbGxvY2F0aW9uc1tpZHhdLmVudmVsb3BlSWQgPSBTdHJpbmcodmFsID8/IFwiXCIpO1xuICAgICAgaWYoZmllbGQgPT09ICdhbW91bnQnKSBhbGxvY2F0aW9uc1tpZHhdLmFtb3VudCA9IE51bWJlcih2YWwgPz8gMCk7XG4gICAgfVxuICB9XG5cbiAgLy8gRmlsdGVyIG91dCBlbXB0eSBhbGxvY2F0aW9uIHNsb3RzXG4gIGNvbnN0IGFsbG9jc0ZpbHRlcmVkID0gYWxsb2NhdGlvbnMuZmlsdGVyKGEgPT4gYSAmJiBhLmVudmVsb3BlSWQgJiYgTnVtYmVyKGEuYW1vdW50KSA+IDApO1xuXG4gIGNvbnN0IGlucHV0ID0geyB0b3RhbCwgYWxsb2NhdGlvbnM6IGFsbG9jc0ZpbHRlcmVkLCBhbGxvd092ZXJyaWRlLCBvdmVycmlkZVJlYXNvbiB9O1xuICByZXR1cm4gY3JlYXRlRXhwZW5zZShpbnB1dCk7XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwicmVxdWlyZVJvbGUiLCJDcmVhdGVJbmNvbWVTY2hlbWEiLCJDcmVhdGVFeHBlbnNlU2NoZW1hIiwieiIsImdldEFsbEVudmVsb3BlQmFsYW5jZXMiLCJjcmVhdGVJbmNvbWUiLCJpbnB1dCIsInBhcnNlZCIsInNhZmVQYXJzZSIsInN1Y2Nlc3MiLCJFcnJvciIsImVycm9yIiwiZXJyb3JzIiwibWFwIiwiZSIsIm1lc3NhZ2UiLCJqb2luIiwidHgiLCJ0cmFuc2FjdGlvbiIsImNyZWF0ZSIsImRhdGEiLCJraW5kIiwibGFiZWwiLCJhbW91bnQiLCJhdCIsIkRhdGUiLCJzZXJ2aWNlSWQiLCJ0cmFuc2FjdGlvbklkIiwiaWQiLCJjcmVhdGVFeHBlbnNlIiwiZW52SWRzIiwiYWxsb2NhdGlvbnMiLCJhIiwiZW52ZWxvcGVJZCIsImVudldpdGhUeXBlcyIsImVudmVsb3BlIiwiZmluZE1hbnkiLCJ3aGVyZSIsImluIiwic2VsZWN0IiwibmFtZSIsInByb3RlY3RlZCIsImFjdGl2ZSIsIk1hcCIsImJhbGFuY2VzIiwiZW52cyIsImVudk1hcCIsImJhbE1hcCIsImIiLCJiYWxhbmNlIiwiYW5vbWFsaWVzIiwiZW52IiwiZ2V0IiwiYXZhaWxhYmxlIiwiYWxsb3dPdmVycmlkZSIsInB1c2giLCJsZXZlbCIsImNvZGUiLCJkZXRhaWxzIiwidG90YWwiLCJ0cmFuc2FjdGlvbkFsbG9jYXRpb24iLCJjcmVhdGVNYW55IiwibGVuZ3RoIiwiYW5vbWFseSIsImFuIiwib3ZlcnJpZGVSZWFzb24iLCJjcmVhdGVUcmFuc2ZlciIsIlNjaGVtYSIsIm9iamVjdCIsImZyb21FbnZlbG9wZUlkIiwic3RyaW5nIiwibWluIiwidG9FbnZlbG9wZUlkIiwibnVtYmVyIiwiaW50IiwicG9zaXRpdmUiLCJib29sZWFuIiwib3B0aW9uYWwiLCJyZWFzb24iLCJtYXgiLCJwIiwiZnJvbUVudiIsInRvRW52Iiwib3V0VHgiLCJpblR4Iiwib3V0VHJhbnNhY3Rpb25JZCIsImluVHJhbnNhY3Rpb25JZCIsImNyZWF0ZUV4cGVuc2VGb3JtIiwiZm9ybURhdGEiLCJ0b3RhbFJhdyIsIk51bWJlciIsIlN0cmluZyIsImtleSIsIkFycmF5IiwiZnJvbSIsImtleXMiLCJtIiwibWF0Y2giLCJpZHgiLCJmaWVsZCIsInZhbCIsImFsbG9jc0ZpbHRlcmVkIiwiZmlsdGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/actions/transactions.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/queries/envelopes.ts":
/*!*****************************************!*\
  !*** ./src/server/queries/envelopes.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getAllEnvelopeBalances: () => (/* binding */ getAllEnvelopeBalances),\n/* harmony export */   getBlockedEnvelopeCoverage: () => (/* binding */ getBlockedEnvelopeCoverage),\n/* harmony export */   getEnvelopeCoverageAll: () => (/* binding */ getEnvelopeCoverageAll)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(action-browser)/./src/lib/prisma.ts\");\n\nasync function getAllEnvelopeBalances() {\n    // Only consider active envelopes for balances shown in the app (dashboard, lists)\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true\n        },\n        select: {\n            id: true,\n            name: true,\n            protected: true,\n            active: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"DIST\"\n            }\n        }\n    });\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            \"envelopeId\"\n        ],\n        _sum: {\n            amount: true\n        },\n        where: {\n            transaction: {\n                kind: \"OUT\"\n            }\n        }\n    });\n    const mapD = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const mapO = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    return envs.map((e)=>{\n        const inflow = mapD.get(e.id) ?? 0, outflow = mapO.get(e.id) ?? 0;\n        const total = typeof e.budgetTarget === 'number' ? e.budgetTarget : inflow;\n        const balance = total - outflow;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            protected: e.protected,\n            active: e.active,\n            emoji: e.emoji ?? null,\n            budgetTarget: e.budgetTarget ?? null,\n            inflow,\n            outflow,\n            balance\n        };\n    });\n}\n// Retourne la couverture (en mois) des enveloppes class√©es \"blocked\" ou prot√©g√©es.\nasync function getBlockedEnvelopeCoverage() {\n    const now = new Date();\n    const daysWindow = 90; // use last 90 days to compute average\n    const since = new Date(now.getTime() - daysWindow * 24 * 3600 * 1000);\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true,\n            OR: [\n                {\n                    protected: true\n                },\n                {\n                    classification: 'blocked'\n                }\n            ]\n        },\n        select: {\n            id: true,\n            name: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    if (envs.length === 0) return [];\n    const ids = envs.map((e)=>e.id);\n    // sum of OUT amounts over the window\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT',\n                at: {\n                    gte: since\n                }\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outMap = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    // current balances using existing helper logic: inflow/outflow all-time\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'DIST'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outsAll = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const distMap = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const outsAllMap = new Map(outsAll.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const res = envs.map((e)=>{\n        const allocated = distMap.get(e.id) ?? 0;\n        const spentAll = outsAllMap.get(e.id) ?? 0;\n        const balance = (typeof e.budgetTarget === 'number' ? e.budgetTarget : allocated) - spentAll;\n        const outLast90 = outMap.get(e.id) ?? 0;\n        const avgMonthly = outLast90 / daysWindow * 30; // approximate month\n        const months = avgMonthly > 0 ? Number((balance / avgMonthly).toFixed(1)) : balance > 0 ? Infinity : 0;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            emoji: e.emoji ?? null,\n            balance,\n            avgMonthly: Math.round(avgMonthly),\n            monthsCoverage: months\n        };\n    });\n    return res;\n}\n// Retourne la couverture (en mois) pour toutes les enveloppes actives.\nasync function getEnvelopeCoverageAll(options) {\n    const daysWindow = options?.daysWindow ?? 90;\n    const now = new Date();\n    const since = new Date(now.getTime() - daysWindow * 24 * 3600 * 1000);\n    const envs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.envelope.findMany({\n        where: {\n            active: true\n        },\n        select: {\n            id: true,\n            name: true,\n            emoji: true,\n            budgetTarget: true\n        }\n    });\n    if (envs.length === 0) return [];\n    const ids = envs.map((e)=>e.id);\n    const outs = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT',\n                at: {\n                    gte: since\n                }\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outMap = new Map(outs.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const dist = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'DIST'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const outsAll = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.transactionAllocation.groupBy({\n        by: [\n            'envelopeId'\n        ],\n        where: {\n            envelopeId: {\n                in: ids\n            },\n            transaction: {\n                kind: 'OUT'\n            }\n        },\n        _sum: {\n            amount: true\n        }\n    });\n    const distMap = new Map(dist.map((d)=>[\n            d.envelopeId,\n            d._sum.amount ?? 0\n        ]));\n    const outsAllMap = new Map(outsAll.map((o)=>[\n            o.envelopeId,\n            o._sum.amount ?? 0\n        ]));\n    const res = envs.map((e)=>{\n        const allocated = distMap.get(e.id) ?? 0;\n        const spentAll = outsAllMap.get(e.id) ?? 0;\n        const balance = (typeof e.budgetTarget === 'number' ? e.budgetTarget : allocated) - spentAll;\n        const outLast = outMap.get(e.id) ?? 0;\n        const avgMonthly = outLast / daysWindow * 30;\n        const months = avgMonthly > 0 ? Number((balance / avgMonthly).toFixed(1)) : balance > 0 ? Infinity : 0;\n        return {\n            envelopeId: e.id,\n            name: e.name,\n            emoji: e.emoji ?? null,\n            balance,\n            avgMonthly: Math.round(avgMonthly),\n            monthsCoverage: months\n        };\n    });\n    return res;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvcXVlcmllcy9lbnZlbG9wZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFzQztBQUMvQixlQUFlQztJQUNwQixrRkFBa0Y7SUFDbEYsTUFBTUMsT0FBSyxNQUFNRiwrQ0FBTUEsQ0FBQ0csUUFBUSxDQUFDQyxRQUFRLENBQUM7UUFBRUMsT0FBTztZQUFFQyxRQUFRO1FBQUs7UUFBR0MsUUFBTztZQUFDQyxJQUFHO1lBQUtDLE1BQUs7WUFBS0MsV0FBVTtZQUFLSixRQUFPO1lBQU1LLE9BQU07WUFBTUMsY0FBYTtRQUFJO0lBQUM7SUFDekosTUFBTUMsT0FBSyxNQUFNYiwrQ0FBTUEsQ0FBQ2MscUJBQXFCLENBQUNDLE9BQU8sQ0FBQztRQUFDQyxJQUFHO1lBQUM7U0FBYTtRQUFFQyxNQUFLO1lBQUNDLFFBQU87UUFBSTtRQUFHYixPQUFNO1lBQUNjLGFBQVk7Z0JBQUNDLE1BQUs7WUFBTTtRQUFDO0lBQUM7SUFDL0gsTUFBTUMsT0FBSyxNQUFNckIsK0NBQU1BLENBQUNjLHFCQUFxQixDQUFDQyxPQUFPLENBQUM7UUFBQ0MsSUFBRztZQUFDO1NBQWE7UUFBRUMsTUFBSztZQUFDQyxRQUFPO1FBQUk7UUFBR2IsT0FBTTtZQUFDYyxhQUFZO2dCQUFDQyxNQUFLO1lBQUs7UUFBQztJQUFDO0lBQzlILE1BQU1FLE9BQUssSUFBSUMsSUFBSVYsS0FBS1csR0FBRyxDQUFDQyxDQUFBQSxJQUFHO1lBQUNBLEVBQUVDLFVBQVU7WUFBRUQsRUFBRVIsSUFBSSxDQUFDQyxNQUFNLElBQUU7U0FBRTtJQUFJLE1BQU1TLE9BQUssSUFBSUosSUFBSUYsS0FBS0csR0FBRyxDQUFDSSxDQUFBQSxJQUFHO1lBQUNBLEVBQUVGLFVBQVU7WUFBRUUsRUFBRVgsSUFBSSxDQUFDQyxNQUFNLElBQUU7U0FBRTtJQUNsSSxPQUFPaEIsS0FBS3NCLEdBQUcsQ0FBQ0ssQ0FBQUE7UUFBSyxNQUFNQyxTQUFPUixLQUFLUyxHQUFHLENBQUNG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LElBQUksQ0FBQ0MsTUFBTSxJQUFJO1NBQUU7SUFDdEUsTUFBTWlDLGFBQWEsSUFBSTVCLElBQUkwQixRQUFRekIsR0FBRyxDQUFDSSxDQUFBQSxJQUFHO1lBQUNBLEVBQUVGLFVBQVU7WUFBRUUsRUFBRVgsSUFBSSxDQUFDQyxNQUFNLElBQUk7U0FBRTtJQUU1RSxNQUFNa0MsTUFBTWxELEtBQUtzQixHQUFHLENBQUNLLENBQUFBO1FBQ25CLE1BQU13QixZQUFZSCxRQUFRbkIsR0FBRyxDQUFDRixFQUFFckIsRUFBRSxLQUFLO1FBQ3ZDLE1BQU04QyxXQUFXSCxXQUFXcEIsR0FBRyxDQUFDRixFQUFFckIsRUFBRSxLQUFLO1FBQ3pDLE1BQU0wQixVQUFVLENBQUMsT0FBT0wsRUFBRWpCLFlBQVksS0FBSyxXQUFXaUIsRUFBRWpCLFlBQVksR0FBR3lDLFNBQVEsSUFBS0M7UUFDcEYsTUFBTVksVUFBVWxCLE9BQU9qQixHQUFHLENBQUNGLEVBQUVyQixFQUFFLEtBQUs7UUFDcEMsTUFBTWdELGFBQWFVLFVBQVU1QixhQUFhO1FBQzFDLE1BQU1tQixTQUFTRCxhQUFhLElBQUlFLE9BQU8sQ0FBQ3hCLFVBQVVzQixVQUFTLEVBQUdHLE9BQU8sQ0FBQyxNQUFPekIsVUFBVSxJQUFJMEIsV0FBVztRQUN0RyxPQUFPO1lBQUVsQyxZQUFZRyxFQUFFckIsRUFBRTtZQUFFQyxNQUFNb0IsRUFBRXBCLElBQUk7WUFBRUUsT0FBT2tCLEVBQUVsQixLQUFLLElBQUk7WUFBTXVCO1lBQVNzQixZQUFZSyxLQUFLQyxLQUFLLENBQUNOO1lBQWFPLGdCQUFnQk47UUFBTztJQUN2STtJQUVBLE9BQU9MO0FBQ1QiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxccXVlcmllc1xcZW52ZWxvcGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHByaXNtYSB9IGZyb20gXCJAL2xpYi9wcmlzbWFcIjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxFbnZlbG9wZUJhbGFuY2VzKCl7XG4gIC8vIE9ubHkgY29uc2lkZXIgYWN0aXZlIGVudmVsb3BlcyBmb3IgYmFsYW5jZXMgc2hvd24gaW4gdGhlIGFwcCAoZGFzaGJvYXJkLCBsaXN0cylcbiAgY29uc3QgZW52cz1hd2FpdCBwcmlzbWEuZW52ZWxvcGUuZmluZE1hbnkoeyB3aGVyZTogeyBhY3RpdmU6IHRydWUgfSwgc2VsZWN0OntpZDp0cnVlLG5hbWU6dHJ1ZSxwcm90ZWN0ZWQ6dHJ1ZSxhY3RpdmU6dHJ1ZSwgZW1vamk6dHJ1ZSwgYnVkZ2V0VGFyZ2V0OnRydWV9fSk7XG4gIGNvbnN0IGRpc3Q9YXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtieTpbXCJlbnZlbG9wZUlkXCJdLCBfc3VtOnthbW91bnQ6dHJ1ZX0sIHdoZXJlOnt0cmFuc2FjdGlvbjp7a2luZDpcIkRJU1RcIn19fSk7XG4gIGNvbnN0IG91dHM9YXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtieTpbXCJlbnZlbG9wZUlkXCJdLCBfc3VtOnthbW91bnQ6dHJ1ZX0sIHdoZXJlOnt0cmFuc2FjdGlvbjp7a2luZDpcIk9VVFwifX19KTtcbiAgY29uc3QgbWFwRD1uZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQ/PzBdKSk7IGNvbnN0IG1hcE89bmV3IE1hcChvdXRzLm1hcChvPT5bby5lbnZlbG9wZUlkLCBvLl9zdW0uYW1vdW50Pz8wXSkpO1xuICByZXR1cm4gZW52cy5tYXAoZT0+eyBjb25zdCBpbmZsb3c9bWFwRC5nZXQoZS5pZCk/PzAsIG91dGZsb3c9bWFwTy5nZXQoZS5pZCk/PzA7IGNvbnN0IHRvdGFsID0gdHlwZW9mIGUuYnVkZ2V0VGFyZ2V0ID09PSAnbnVtYmVyJyA/IGUuYnVkZ2V0VGFyZ2V0IDogaW5mbG93OyBjb25zdCBiYWxhbmNlID0gdG90YWwgLSBvdXRmbG93OyByZXR1cm4geyBlbnZlbG9wZUlkOmUuaWQsIG5hbWU6ZS5uYW1lLCBwcm90ZWN0ZWQ6ZS5wcm90ZWN0ZWQsIGFjdGl2ZTplLmFjdGl2ZSwgZW1vamk6IGUuZW1vamkgPz8gbnVsbCwgYnVkZ2V0VGFyZ2V0OiBlLmJ1ZGdldFRhcmdldCA/PyBudWxsLCBpbmZsb3csIG91dGZsb3csIGJhbGFuY2UgfTsgfSk7XG59XG5cbi8vIFJldG91cm5lIGxhIGNvdXZlcnR1cmUgKGVuIG1vaXMpIGRlcyBlbnZlbG9wcGVzIGNsYXNzw6llcyBcImJsb2NrZWRcIiBvdSBwcm90w6lnw6llcy5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRCbG9ja2VkRW52ZWxvcGVDb3ZlcmFnZSgpe1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBkYXlzV2luZG93ID0gOTA7IC8vIHVzZSBsYXN0IDkwIGRheXMgdG8gY29tcHV0ZSBhdmVyYWdlXG4gIGNvbnN0IHNpbmNlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSAtIGRheXNXaW5kb3cgKiAyNCAqIDM2MDAgKiAxMDAwKTtcblxuICBjb25zdCBlbnZzID0gYXdhaXQgcHJpc21hLmVudmVsb3BlLmZpbmRNYW55KHsgd2hlcmU6IHsgYWN0aXZlOiB0cnVlLCBPUjogW3sgcHJvdGVjdGVkOiB0cnVlIH0sIHsgY2xhc3NpZmljYXRpb246ICdibG9ja2VkJyB9XSB9LCBzZWxlY3Q6IHsgaWQ6dHJ1ZSwgbmFtZTp0cnVlLCBlbW9qaTp0cnVlLCBidWRnZXRUYXJnZXQ6dHJ1ZSB9IH0pO1xuICBpZihlbnZzLmxlbmd0aD09PTApIHJldHVybiBbXSBhcyBhbnlbXTtcblxuICBjb25zdCBpZHMgPSBlbnZzLm1hcChlPT5lLmlkKTtcblxuICAvLyBzdW0gb2YgT1VUIGFtb3VudHMgb3ZlciB0aGUgd2luZG93XG4gIGNvbnN0IG91dHMgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoe1xuICAgIGJ5OiBbJ2VudmVsb3BlSWQnXSxcbiAgICB3aGVyZTogeyBlbnZlbG9wZUlkOiB7IGluOiBpZHMgfSwgdHJhbnNhY3Rpb246IHsga2luZDogJ09VVCcsIGF0OiB7IGd0ZTogc2luY2UgfSB9IH0sXG4gICAgX3N1bTogeyBhbW91bnQ6IHRydWUgfVxuICB9KTtcblxuICBjb25zdCBvdXRNYXAgPSBuZXcgTWFwKG91dHMubWFwKG89PltvLmVudmVsb3BlSWQsIG8uX3N1bS5hbW91bnQgPz8gMF0pKTtcblxuICAvLyBjdXJyZW50IGJhbGFuY2VzIHVzaW5nIGV4aXN0aW5nIGhlbHBlciBsb2dpYzogaW5mbG93L291dGZsb3cgYWxsLXRpbWVcbiAgY29uc3QgZGlzdCA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbkFsbG9jYXRpb24uZ3JvdXBCeSh7IGJ5OiBbJ2VudmVsb3BlSWQnXSwgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdESVNUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IG91dHNBbGwgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoeyBieTogWydlbnZlbG9wZUlkJ10sIHdoZXJlOiB7IGVudmVsb3BlSWQ6IHsgaW46IGlkcyB9LCB0cmFuc2FjdGlvbjogeyBraW5kOiAnT1VUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IGRpc3RNYXAgPSBuZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQgPz8gMF0pKTtcbiAgY29uc3Qgb3V0c0FsbE1hcCA9IG5ldyBNYXAob3V0c0FsbC5tYXAobz0+W28uZW52ZWxvcGVJZCwgby5fc3VtLmFtb3VudCA/PyAwXSkpO1xuXG4gIGNvbnN0IHJlcyA9IGVudnMubWFwKGU9PntcbiAgICBjb25zdCBhbGxvY2F0ZWQgPSBkaXN0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IHNwZW50QWxsID0gb3V0c0FsbE1hcC5nZXQoZS5pZCkgPz8gMDtcbiAgICBjb25zdCBiYWxhbmNlID0gKHR5cGVvZiBlLmJ1ZGdldFRhcmdldCA9PT0gJ251bWJlcicgPyBlLmJ1ZGdldFRhcmdldCA6IGFsbG9jYXRlZCkgLSBzcGVudEFsbDtcbiAgICBjb25zdCBvdXRMYXN0OTAgPSBvdXRNYXAuZ2V0KGUuaWQpID8/IDA7XG4gICAgY29uc3QgYXZnTW9udGhseSA9IG91dExhc3Q5MCAvIGRheXNXaW5kb3cgKiAzMDsgLy8gYXBwcm94aW1hdGUgbW9udGhcbiAgICBjb25zdCBtb250aHMgPSBhdmdNb250aGx5ID4gMCA/IE51bWJlcigoYmFsYW5jZSAvIGF2Z01vbnRobHkpLnRvRml4ZWQoMSkpIDogKGJhbGFuY2UgPiAwID8gSW5maW5pdHkgOiAwKTtcbiAgICByZXR1cm4geyBlbnZlbG9wZUlkOiBlLmlkLCBuYW1lOiBlLm5hbWUsIGVtb2ppOiBlLmVtb2ppID8/IG51bGwsIGJhbGFuY2UsIGF2Z01vbnRobHk6IE1hdGgucm91bmQoYXZnTW9udGhseSksIG1vbnRoc0NvdmVyYWdlOiBtb250aHMgfTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlcztcbn1cblxuLy8gUmV0b3VybmUgbGEgY291dmVydHVyZSAoZW4gbW9pcykgcG91ciB0b3V0ZXMgbGVzIGVudmVsb3BwZXMgYWN0aXZlcy5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbnZlbG9wZUNvdmVyYWdlQWxsKG9wdGlvbnM/OiB7IGRheXNXaW5kb3c/OiBudW1iZXIgfSl7XG4gIGNvbnN0IGRheXNXaW5kb3cgPSBvcHRpb25zPy5kYXlzV2luZG93ID8/IDkwO1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICBjb25zdCBzaW5jZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgLSBkYXlzV2luZG93ICogMjQgKiAzNjAwICogMTAwMCk7XG5cbiAgY29uc3QgZW52cyA9IGF3YWl0IHByaXNtYS5lbnZlbG9wZS5maW5kTWFueSh7IHdoZXJlOiB7IGFjdGl2ZTogdHJ1ZSB9LCBzZWxlY3Q6IHsgaWQ6dHJ1ZSwgbmFtZTp0cnVlLCBlbW9qaTp0cnVlLCBidWRnZXRUYXJnZXQ6dHJ1ZSB9IH0pO1xuICBpZihlbnZzLmxlbmd0aD09PTApIHJldHVybiBbXSBhcyBhbnlbXTtcblxuICBjb25zdCBpZHMgPSBlbnZzLm1hcChlPT5lLmlkKTtcblxuICBjb25zdCBvdXRzID0gYXdhaXQgcHJpc21hLnRyYW5zYWN0aW9uQWxsb2NhdGlvbi5ncm91cEJ5KHtcbiAgICBieTogWydlbnZlbG9wZUlkJ10sXG4gICAgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdPVVQnLCBhdDogeyBndGU6IHNpbmNlIH0gfSB9LFxuICAgIF9zdW06IHsgYW1vdW50OiB0cnVlIH1cbiAgfSk7XG5cbiAgY29uc3Qgb3V0TWFwID0gbmV3IE1hcChvdXRzLm1hcChvPT5bby5lbnZlbG9wZUlkLCBvLl9zdW0uYW1vdW50ID8/IDBdKSk7XG5cbiAgY29uc3QgZGlzdCA9IGF3YWl0IHByaXNtYS50cmFuc2FjdGlvbkFsbG9jYXRpb24uZ3JvdXBCeSh7IGJ5OiBbJ2VudmVsb3BlSWQnXSwgd2hlcmU6IHsgZW52ZWxvcGVJZDogeyBpbjogaWRzIH0sIHRyYW5zYWN0aW9uOiB7IGtpbmQ6ICdESVNUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IG91dHNBbGwgPSBhd2FpdCBwcmlzbWEudHJhbnNhY3Rpb25BbGxvY2F0aW9uLmdyb3VwQnkoeyBieTogWydlbnZlbG9wZUlkJ10sIHdoZXJlOiB7IGVudmVsb3BlSWQ6IHsgaW46IGlkcyB9LCB0cmFuc2FjdGlvbjogeyBraW5kOiAnT1VUJyB9IH0sIF9zdW06IHsgYW1vdW50OiB0cnVlIH0gfSk7XG4gIGNvbnN0IGRpc3RNYXAgPSBuZXcgTWFwKGRpc3QubWFwKGQ9PltkLmVudmVsb3BlSWQsIGQuX3N1bS5hbW91bnQgPz8gMF0pKTtcbiAgY29uc3Qgb3V0c0FsbE1hcCA9IG5ldyBNYXAob3V0c0FsbC5tYXAobz0+W28uZW52ZWxvcGVJZCwgby5fc3VtLmFtb3VudCA/PyAwXSkpO1xuXG4gIGNvbnN0IHJlcyA9IGVudnMubWFwKGU9PntcbiAgICBjb25zdCBhbGxvY2F0ZWQgPSBkaXN0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IHNwZW50QWxsID0gb3V0c0FsbE1hcC5nZXQoZS5pZCkgPz8gMDtcbiAgICBjb25zdCBiYWxhbmNlID0gKHR5cGVvZiBlLmJ1ZGdldFRhcmdldCA9PT0gJ251bWJlcicgPyBlLmJ1ZGdldFRhcmdldCA6IGFsbG9jYXRlZCkgLSBzcGVudEFsbDtcbiAgICBjb25zdCBvdXRMYXN0ID0gb3V0TWFwLmdldChlLmlkKSA/PyAwO1xuICAgIGNvbnN0IGF2Z01vbnRobHkgPSBvdXRMYXN0IC8gZGF5c1dpbmRvdyAqIDMwO1xuICAgIGNvbnN0IG1vbnRocyA9IGF2Z01vbnRobHkgPiAwID8gTnVtYmVyKChiYWxhbmNlIC8gYXZnTW9udGhseSkudG9GaXhlZCgxKSkgOiAoYmFsYW5jZSA+IDAgPyBJbmZpbml0eSA6IDApO1xuICAgIHJldHVybiB7IGVudmVsb3BlSWQ6IGUuaWQsIG5hbWU6IGUubmFtZSwgZW1vamk6IGUuZW1vamkgPz8gbnVsbCwgYmFsYW5jZSwgYXZnTW9udGhseTogTWF0aC5yb3VuZChhdmdNb250aGx5KSwgbW9udGhzQ292ZXJhZ2U6IG1vbnRocyB9O1xuICB9KTtcblxuICByZXR1cm4gcmVzO1xufVxuIl0sIm5hbWVzIjpbInByaXNtYSIsImdldEFsbEVudmVsb3BlQmFsYW5jZXMiLCJlbnZzIiwiZW52ZWxvcGUiLCJmaW5kTWFueSIsIndoZXJlIiwiYWN0aXZlIiwic2VsZWN0IiwiaWQiLCJuYW1lIiwicHJvdGVjdGVkIiwiZW1vamkiLCJidWRnZXRUYXJnZXQiLCJkaXN0IiwidHJhbnNhY3Rpb25BbGxvY2F0aW9uIiwiZ3JvdXBCeSIsImJ5IiwiX3N1bSIsImFtb3VudCIsInRyYW5zYWN0aW9uIiwia2luZCIsIm91dHMiLCJtYXBEIiwiTWFwIiwibWFwIiwiZCIsImVudmVsb3BlSWQiLCJtYXBPIiwibyIsImUiLCJpbmZsb3ciLCJnZXQiLCJvdXRmbG93IiwidG90YWwiLCJiYWxhbmNlIiwiZ2V0QmxvY2tlZEVudmVsb3BlQ292ZXJhZ2UiLCJub3ciLCJEYXRlIiwiZGF5c1dpbmRvdyIsInNpbmNlIiwiZ2V0VGltZSIsIk9SIiwiY2xhc3NpZmljYXRpb24iLCJsZW5ndGgiLCJpZHMiLCJpbiIsImF0IiwiZ3RlIiwib3V0TWFwIiwib3V0c0FsbCIsImRpc3RNYXAiLCJvdXRzQWxsTWFwIiwicmVzIiwiYWxsb2NhdGVkIiwic3BlbnRBbGwiLCJvdXRMYXN0OTAiLCJhdmdNb250aGx5IiwibW9udGhzIiwiTnVtYmVyIiwidG9GaXhlZCIsIkluZmluaXR5IiwiTWF0aCIsInJvdW5kIiwibW9udGhzQ292ZXJhZ2UiLCJnZXRFbnZlbG9wZUNvdmVyYWdlQWxsIiwib3B0aW9ucyIsIm91dExhc3QiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/queries/envelopes.ts\n");

/***/ }),

/***/ "(action-browser)/./src/server/validators/transactions.ts":
/*!***********************************************!*\
  !*** ./src/server/validators/transactions.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CreateExpenseSchema: () => (/* binding */ CreateExpenseSchema),\n/* harmony export */   CreateIncomeSchema: () => (/* binding */ CreateIncomeSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(action-browser)/./node_modules/.pnpm/zod@3.23.8/node_modules/zod/lib/index.mjs\");\n\nconst CreateIncomeSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    serviceId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1),\n    amount: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().positive(),\n    note: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(500).optional()\n});\nconst CreateExpenseSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    total: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().positive(),\n    allocations: zod__WEBPACK_IMPORTED_MODULE_0__.z.array(zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n        envelopeId: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().min(1),\n        amount: zod__WEBPACK_IMPORTED_MODULE_0__.z.number().int().positive()\n    })).min(1),\n    allowOverride: zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean().optional(),\n    overrideReason: zod__WEBPACK_IMPORTED_MODULE_0__.z.string().max(500).optional()\n}).refine((v)=>v.allocations.reduce((s, a)=>s + a.amount, 0) === v.total, \"Somme des allocations ‚â† total\").refine((v)=>!v.allowOverride || v.overrideReason && v.overrideReason.trim().length >= 5, \"overrideReason (‚â• 5 caract√®res) requis si allowOverride = true\");\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFjdGlvbi1icm93c2VyKS8uL3NyYy9zZXJ2ZXIvdmFsaWRhdG9ycy90cmFuc2FjdGlvbnMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQXdCO0FBQ2pCLE1BQU1DLHFCQUFxQkQsa0NBQUNBLENBQUNFLE1BQU0sQ0FBQztJQUFFQyxXQUFXSCxrQ0FBQ0EsQ0FBQ0ksTUFBTSxHQUFHQyxHQUFHLENBQUM7SUFBSUMsUUFBUU4sa0NBQUNBLENBQUNPLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxRQUFRO0lBQUlDLE1BQU1WLGtDQUFDQSxDQUFDSSxNQUFNLEdBQUdPLEdBQUcsQ0FBQyxLQUFLQyxRQUFRO0FBQUcsR0FBRztBQUNqSixNQUFNQyxzQkFBc0JiLGtDQUFDQSxDQUFDRSxNQUFNLENBQUM7SUFDMUNZLE9BQU9kLGtDQUFDQSxDQUFDTyxNQUFNLEdBQUdDLEdBQUcsR0FBR0MsUUFBUTtJQUNoQ00sYUFBYWYsa0NBQUNBLENBQUNnQixLQUFLLENBQUNoQixrQ0FBQ0EsQ0FBQ0UsTUFBTSxDQUFDO1FBQUVlLFlBQVdqQixrQ0FBQ0EsQ0FBQ0ksTUFBTSxHQUFHQyxHQUFHLENBQUM7UUFBSUMsUUFBT04sa0NBQUNBLENBQUNPLE1BQU0sR0FBR0MsR0FBRyxHQUFHQyxRQUFRO0lBQUcsSUFBSUosR0FBRyxDQUFDO0lBQ3pHYSxlQUFlbEIsa0NBQUNBLENBQUNtQixPQUFPLEdBQUdQLFFBQVE7SUFBSVEsZ0JBQWdCcEIsa0NBQUNBLENBQUNJLE1BQU0sR0FBR08sR0FBRyxDQUFDLEtBQUtDLFFBQVE7QUFDckYsR0FBR1MsTUFBTSxDQUFDQyxDQUFBQSxJQUFJQSxFQUFFUCxXQUFXLENBQUNRLE1BQU0sQ0FBQyxDQUFDQyxHQUFFQyxJQUFJRCxJQUFFQyxFQUFFbkIsTUFBTSxFQUFDLE9BQUtnQixFQUFFUixLQUFLLEVBQUUsaUNBQ2pFTyxNQUFNLENBQUNDLENBQUFBLElBQUksQ0FBQ0EsRUFBRUosYUFBYSxJQUFLSSxFQUFFRixjQUFjLElBQUlFLEVBQUVGLGNBQWMsQ0FBQ00sSUFBSSxHQUFHQyxNQUFNLElBQUUsR0FBSSxrRUFBa0UiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcQkMyNDFcXE11c2ljXFxmaW5hbmNlLWFwcC12MS1tYWluXFxmaW5hbmNlLWFwcC12MS1tYWluXFxzcmNcXHNlcnZlclxcdmFsaWRhdG9yc1xcdHJhbnNhY3Rpb25zLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5leHBvcnQgY29uc3QgQ3JlYXRlSW5jb21lU2NoZW1hID0gei5vYmplY3QoeyBzZXJ2aWNlSWQ6IHouc3RyaW5nKCkubWluKDEpLCBhbW91bnQ6IHoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKSwgbm90ZTogei5zdHJpbmcoKS5tYXgoNTAwKS5vcHRpb25hbCgpIH0pO1xuZXhwb3J0IGNvbnN0IENyZWF0ZUV4cGVuc2VTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHRvdGFsOiB6Lm51bWJlcigpLmludCgpLnBvc2l0aXZlKCksXG4gIGFsbG9jYXRpb25zOiB6LmFycmF5KHoub2JqZWN0KHsgZW52ZWxvcGVJZDp6LnN0cmluZygpLm1pbigxKSwgYW1vdW50OnoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKSB9KSkubWluKDEpLFxuICBhbGxvd092ZXJyaWRlOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLCBvdmVycmlkZVJlYXNvbjogei5zdHJpbmcoKS5tYXgoNTAwKS5vcHRpb25hbCgpXG59KS5yZWZpbmUodj0+IHYuYWxsb2NhdGlvbnMucmVkdWNlKChzLGEpPT5zK2EuYW1vdW50LDApPT09di50b3RhbCwgXCJTb21tZSBkZXMgYWxsb2NhdGlvbnMg4omgIHRvdGFsXCJcbikucmVmaW5lKHY9PiAhdi5hbGxvd092ZXJyaWRlIHx8ICh2Lm92ZXJyaWRlUmVhc29uICYmIHYub3ZlcnJpZGVSZWFzb24udHJpbSgpLmxlbmd0aD49NSksIFwib3ZlcnJpZGVSZWFzb24gKOKJpSA1IGNhcmFjdMOocmVzKSByZXF1aXMgc2kgYWxsb3dPdmVycmlkZSA9IHRydWVcIik7XG4iXSwibmFtZXMiOlsieiIsIkNyZWF0ZUluY29tZVNjaGVtYSIsIm9iamVjdCIsInNlcnZpY2VJZCIsInN0cmluZyIsIm1pbiIsImFtb3VudCIsIm51bWJlciIsImludCIsInBvc2l0aXZlIiwibm90ZSIsIm1heCIsIm9wdGlvbmFsIiwiQ3JlYXRlRXhwZW5zZVNjaGVtYSIsInRvdGFsIiwiYWxsb2NhdGlvbnMiLCJhcnJheSIsImVudmVsb3BlSWQiLCJhbGxvd092ZXJyaWRlIiwiYm9vbGVhbiIsIm92ZXJyaWRlUmVhc29uIiwicmVmaW5lIiwidiIsInJlZHVjZSIsInMiLCJhIiwidHJpbSIsImxlbmd0aCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(action-browser)/./src/server/validators/transactions.ts\n");

/***/ })

};
;